<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PassBox - æœ¬åœ°å¯†ç ç®¡ç†å™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* iOS åŸºç¡€æ ·å¼ */
        :root {
            /* iOS ç³»ç»Ÿè‰²å½© */
            --ios-primary: #007AFF;
            --ios-secondary: #5856D6;
            --ios-success: #34C759;
            --ios-warning: #FF9500;
            --ios-danger: #FF3B30;
            --ios-gray: #8E8E93;
            --ios-gray-light: #C7C7CC;
            --ios-gray-dark: #48484A;
            --ios-background: #F2F2F7;
            --ios-card: #FFFFFF;
            --ios-text-primary: #000000;
            --ios-text-secondary: #8E8E93;
            --ios-text-tertiary: #C7C7CC;
            
            /* iOS åœ†è§’ */
            --ios-corner-small: 8px;
            --ios-corner-medium: 12px;
            --ios-corner-large: 16px;
            --ios-corner-xl: 28px;
            
            /* iOS é˜´å½± */
            --ios-shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
            --ios-shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --ios-shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        body {
            /* iOS ç³»ç»Ÿå­—ä½“ */
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Icons', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: var(--ios-background);
            color: var(--ios-text-primary);
            min-height: 100vh;
            padding: 0;
            margin: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow: hidden; /* ç¦æ­¢é¡µé¢æ»šåŠ¨ */
        }

        /* iOS å®¹å™¨æ ·å¼ */
        .container {
            width: 100%;
            margin: 0;
            background: transparent;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
        }

        /* iOS å¯¼èˆªæ æ ·å¼ */
        header {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--ios-text-primary);
            padding: 16px 20px;
            text-align: center;
            border-bottom: 1px solid var(--ios-gray-light);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 {
            font-size: 17px;
            font-weight: 600;
            letter-spacing: -0.3px;
        }

        /* è‡ªå®šä¹‰iOSé£æ ¼æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--ios-gray-light);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--ios-gray);
        }

        .content {
            padding: 8px;
            overflow: hidden;
            height: calc(100vh - 150px);
            display: flex;
        }

        /* iOS è®¤è¯ç•Œé¢æ ·å¼ */
        .auth-container {
            max-width: 375px;
            margin: 60px auto;
            padding: 24px;
            background: var(--ios-card);
            border-radius: var(--ios-corner-xl);
            box-shadow: var(--ios-shadow-md);
            overflow: hidden;
        }

        .auth-title {
            text-align: center;
            margin-bottom: 8px;
            color: var(--ios-text-primary);
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .auth-subtitle {
            text-align: center;
            margin-bottom: 32px;
            color: var(--ios-text-secondary);
            font-size: 17px;
            font-weight: 400;
            letter-spacing: -0.3px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--ios-text-primary);
            font-size: 13px;
            letter-spacing: -0.1px;
        }

        /* æ·»åŠ æ–°å¯†ç ç•Œé¢çš„å°é—´è· */
        #addPasswordScreen .form-group {
            margin-bottom: 12px;
        }

        #addPasswordScreen label {
            margin-bottom: 6px;
            font-size: 12px;
        }

        /* iOS æ–‡æœ¬æ¡†æ ·å¼ */
        input {
            width: 100%;
            padding: 16px;
            border: 1px solid var(--ios-gray-light);
            border-radius: var(--ios-corner-large);
            font-size: 17px;
            color: var(--ios-text-primary);
            background-color: var(--ios-card);
            transition: all 0.2s ease;
            font-family: inherit;
            letter-spacing: -0.3px;
        }

        /* æ·»åŠ æ–°å¯†ç ç•Œé¢çš„å°å°ºå¯¸è¾“å…¥æ¡† */
        #addPasswordScreen input {
            padding: 8px;
            font-size: 14px;
            min-height: 32px;
        }

        input:focus {
            outline: none;
            border-color: var(--ios-primary);
            background-color: var(--ios-card);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.15);
        }

        input::placeholder {
            color: var(--ios-text-tertiary);
        }

        /* iOS æŒ‰é’®åŸºç¡€æ ·å¼ */
        .btn {
            border: none;
            padding: 16px;
            border-radius: var(--ios-corner-large);
            font-size: 17px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
            font-family: inherit;
            letter-spacing: -0.3px;
            min-height: 48px;
        }

        /* æ·»åŠ æ–°å¯†ç ç•Œé¢çš„å°å°ºå¯¸æŒ‰é’® */
        #addPasswordScreen .btn {
            padding: 8px;
            font-size: 14px;
            min-height: 32px;
        }

        /* iOS ä¸»æŒ‰é’®æ ·å¼ - è“è‰² */
        .btn-primary {
            background-color: var(--ios-primary);
            color: white;
            box-shadow: var(--ios-shadow-sm);
        }
        
        /* å°å°ºå¯¸æŒ‰é’®æ ·å¼ï¼ˆå½“å‰å°ºå¯¸çš„50%ï¼‰ */
        .btn-small {
            padding: 8px !important;
            font-size: 14px !important;
            min-height: 24px !important;
        }
        
        .btn-small .btn-icon {
            font-size: 14px !important;
        }

        .btn-primary:hover {
            background-color: #0056CC;
            box-shadow: var(--ios-shadow-md);
        }

        .btn-primary:active {
            background-color: #0048A8;
            transform: scale(0.98);
        }

        /* iOS æ¬¡è¦æŒ‰é’®æ ·å¼ - ç°è‰² */
        .btn-secondary {
            background-color: var(--ios-gray-light);
            color: var(--ios-text-primary);
        }

        .btn-secondary:hover {
            background-color: #B0B0B5;
        }

        .btn-secondary:active {
            background-color: #9A9AA0;
            transform: scale(0.98);
        }

        /* iOS æˆåŠŸæŒ‰é’®æ ·å¼ - ç»¿è‰² */
        .btn-success {
            background-color: var(--ios-success);
            color: white;
            box-shadow: var(--ios-shadow-sm);
        }

        .btn-success:hover {
            background-color: #28A745;
            box-shadow: var(--ios-shadow-md);
        }

        .btn-success:active {
            background-color: #218838;
            transform: scale(0.98);
        }

        /* æŒ‰é’®å›¾æ ‡æ ·å¼ */
        .btn-icon {
            font-size: 20px;
            font-weight: 400;
        }

        /* è®¤è¯ç•Œé¢æŒ‰é’®æ ·å¼ */
        .btn-login {
            background-color: var(--ios-primary);
            color: white;
            width: 100%;
            margin-top: 16px;
            box-shadow: var(--ios-shadow-sm);
        }

        .btn-login:hover {
            background-color: #0056CC;
            box-shadow: var(--ios-shadow-md);
        }

        .btn-login:active {
            background-color: #0048A8;
            transform: scale(0.98);
        }

        .btn-forgot {
            background-color: transparent;
            color: var(--ios-primary);
            width: 100%;
            margin-top: 12px;
            font-size: 15px;
            font-weight: 500;
        }

        .btn-forgot:hover {
            background-color: rgba(0, 122, 255, 0.08);
        }

        .btn-forgot:active {
            background-color: rgba(0, 122, 255, 0.15);
            transform: scale(0.98);
        }

        /* è®¾ç½®ä¸»å¯†ç æŒ‰é’®æ ·å¼ */
        .btn-setup {
            background-color: var(--ios-primary);
            color: white;
            width: 100%;
            margin-top: 16px;
            box-shadow: var(--ios-shadow-sm);
        }

        .btn-setup:hover {
            background-color: #0056CC;
            box-shadow: var(--ios-shadow-md);
        }

        .btn-setup:active {
            background-color: #0048A8;
            transform: scale(0.98);
        }

        /* iOS é”™è¯¯æ¶ˆæ¯æ ·å¼ */
        .error-message {
            color: var(--ios-danger);
            margin-top: 8px;
            font-size: 14px;
            text-align: center;
            font-weight: 400;
            letter-spacing: -0.2px;
        }

        /* iOS è¡¨å•åŒºåŸŸæ ·å¼ */
        .form-section {
            margin-bottom: 0;
            padding: 20px;
            background: var(--ios-card);
            border-radius: var(--ios-corner-large);
            box-shadow: var(--ios-shadow-sm);
            height: 100%;
        }

        /* iOS æ ‡é¢˜æ ·å¼ */
        h2 {
            font-size: 20px;
            margin-bottom: 20px;
            color: var(--ios-text-primary);
            font-weight: 700;
            letter-spacing: -0.4px;
        }

        /* iOS å¯†ç åˆ—è¡¨åŒºåŸŸ */
        .passwords-section {
            margin-top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* iOS å¯†ç é¡¹æ ·å¼ */
        .password-item {
            background: var(--ios-card);
            border: 1px solid var(--ios-gray-light);
            border-radius: var(--ios-corner-large);
            padding: 20px;
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
            box-shadow: var(--ios-shadow-sm);
        }

        .password-item:hover {
            box-shadow: var(--ios-shadow-md);
            border-color: var(--ios-gray);
        }

        /* iOS å¯†ç ä¿¡æ¯æ ·å¼ */
        .password-info h3 {
            font-size: 17px;
            margin-bottom: 4px;
            color: var(--ios-text-primary);
            font-weight: 600;
            letter-spacing: -0.3px;
        }

        .password-info p {
            font-size: 14px;
            color: var(--ios-text-secondary);
            margin-bottom: 4px;
            font-weight: 400;
            letter-spacing: -0.2px;
        }

        /* å¯†ç è¡Œæ ·å¼ */
        .password-row {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--ios-text-secondary);
            margin-bottom: 4px;
            font-weight: 400;
            letter-spacing: -0.2px;
        }

        /* å¯†ç æ–‡æœ¬æ ·å¼ */
        .password-text {
            font-family: monospace;
            transition: all 0.2s ease;
        }

        /* å¯†ç å¯è§æ—¶çš„æ ·å¼ */
        .password-text.visible {
            color: var(--ios-text-primary);
            font-weight: 500;
        }

        /* å¯†ç åˆ‡æ¢æŒ‰é’®æ ·å¼ */
        .password-toggle {
            padding: 6px 10px !important;
            min-height: 28px !important;
            font-size: 12px !important;
            background-color: transparent !important;
            border: 1px solid var(--ios-gray-light) !important;
            color: var(--ios-gray) !important;
            box-shadow: none !important;
        }

        .password-toggle:hover {
            background-color: rgba(0, 0, 0, 0.05) !important;
            border-color: var(--ios-gray) !important;
            color: var(--ios-gray-dark) !important;
        }

        /* å¯†ç å¯è§æ—¶çš„æŒ‰é’®æ ·å¼ */
        .password-toggle.visible {
            color: var(--ios-primary) !important;
            border-color: var(--ios-primary) !important;
        }

        .password-toggle.visible:hover {
            background-color: rgba(0, 122, 255, 0.05) !important;
        }

        /* äºŒæ¬¡å®‰å…¨éªŒè¯å¾½ç« æ ·å¼ */
        .secondary-auth-badge {
            font-size: 14px;
            color: var(--ios-primary);
            font-weight: bold;
        }

        /* äºŒæ¬¡å®‰å…¨éªŒè¯å¼¹çª—æ ·å¼ */
        .secondary-auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000000;
            animation: fade-in 0.3s ease;
        }

        .secondary-auth-modal-content {
            background-color: var(--ios-card);
            border-radius: var(--ios-corner-xl);
            padding: 24px;
            width: 90%;
            max-width: 400px;
            box-shadow: var(--ios-shadow-lg);
            animation: slide-up 0.3s ease;
        }

        .secondary-auth-modal h3 {
            margin-bottom: 16px;
            font-size: 18px;
            font-weight: 600;
            color: var(--ios-text-primary);
        }

        .secondary-auth-modal .form-group {
            margin-bottom: 20px;
        }

        .secondary-auth-modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }

        /* iOS å¯†ç æ“ä½œæŒ‰é’®å®¹å™¨ */
        .password-actions {
            display: flex;
            gap: 12px;
        }

        /* iOS å°æŒ‰é’®æ ·å¼ */
        .btn-sm {
            padding: 10px 16px;
            font-size: 14px;
            min-height: 36px;
            border-radius: var(--ios-corner-medium);
        }

        /* iOS åˆ é™¤æŒ‰é’®æ ·å¼ - çº¢è‰² */
        .btn-delete {
            background-color: var(--ios-danger);
            color: white;
            border: none;
            box-shadow: var(--ios-shadow-sm);
        }

        .btn-delete:hover {
            background-color: #CC2E23;
            box-shadow: var(--ios-shadow-md);
        }

        .btn-delete:active {
            background-color: #A8261E;
            transform: scale(0.98);
        }

        /* iOS å¤åˆ¶æŒ‰é’®æ ·å¼ - ç»¿è‰² */
        .btn-copy {
            background-color: var(--ios-success);
            color: white;
            border: none;
            box-shadow: var(--ios-shadow-sm);
        }

        .btn-copy:hover {
            background-color: #28A745;
            box-shadow: var(--ios-shadow-md);
        }

        .btn-copy:active {
            background-color: #218838;
            transform: scale(0.98);
        }

        /* iOS ç©ºçŠ¶æ€æ ·å¼ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--ios-text-secondary);
            background: var(--ios-card);
            border-radius: var(--ios-corner-large);
            box-shadow: var(--ios-shadow-sm);
        }

        .empty-state::before {
            content: "ğŸ“­";
            font-size: 60px;
            display: block;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        /* ç•Œé¢å®¹å™¨ */
        #authScreen {
            display: none;
        }

        #setupScreen {
            display: none;
        }

        #passwordManagerScreen {
            display: none;
            height: 100%;
        }

        /* Element Plus é£æ ¼é€šçŸ¥ç»„ä»¶æ ·å¼ */
        .el-message {
            min-width: 300px;
            box-sizing: border-box;
            border-radius: 4px;
            border: 1px solid #ebeef5;
            position: fixed;
            right: 20px;
            top: 20px;
            background-color: #edf2fc;
            transition: opacity .3s, transform .3s, top .4s;
            padding: 15px 15px 15px 20px;
            display: flex;
            align-items: center;
            z-index: 999999;
            overflow: hidden;
            opacity: 1;
            transform: translateY(0);
        }

        .el-message__icon {
            margin-right: 10px;
            font-size: 18px;
        }

        .el-message__content {
            line-height: 1;
            font-size: 14px;
            color: #303133;
        }

        .el-message__closeBtn {
            position: absolute;
            top: 50%;
            right: 15px;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 16px;
            color: #c0c4cc;
            transition: color .3s;
        }

        .el-message__closeBtn:hover {
            color: #909399;
        }

        /* é€šçŸ¥ç±»å‹æ ·å¼ */
        .el-message.success {
            background-color: #f0f9eb;
            border-color: #e1f3d8;
        }

        .el-message.success .el-message__icon {
            color: #67c23a;
        }

        .el-message.warning {
            background-color: #fdf6ec;
            border-color: #faecd8;
        }

        .el-message.warning .el-message__icon {
            color: #e6a23c;
        }

        .el-message.error {
            background-color: #fef0f0;
            border-color: #fbc4c4;
        }

        .el-message.error .el-message__icon {
            color: #f56c6c;
        }

        .el-message.info {
            background-color: #edf2fc;
            border-color: #ebeef5;
        }

        .el-message.info .el-message__icon {
            color: #909399;
        }

        /* é€šçŸ¥åŠ¨ç”» */
        @keyframes message-fade-in {
            0% {
                opacity: 0;
                transform: translateX(100%);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes message-fade-out {
            0% {
                opacity: 1;
                transform: translateX(0);
            }
            100% {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        .el-message-fade-enter {
            animation: message-fade-in 0.3s forwards;
        }

        .el-message-fade-leave {
            animation: message-fade-out 0.3s forwards;
        }
    /* è®¾ç½®ç•Œé¢å¸ƒå±€ */
    .settings-layout {
        display: flex;
        height: calc(100vh - 60px);
        overflow: hidden;
    }

    /* å·¦ä¾§è®¾ç½®é¡¹å¯¼èˆª */
    .settings-sidebar {
        width: 200px;
        background: var(--ios-card);
        border-right: 1px solid var(--ios-gray-light);
        padding: 16px 0;
        overflow-y: auto;
    }

    /* è®¾ç½®é¡¹æŒ‰é’®æ ·å¼ */
    .settings-item {
        display: block;
        width: 100%;
        padding: 16px 20px;
        border: none;
        background: transparent;
        text-align: left;
        font-size: 16px;
        color: var(--ios-text-primary);
        cursor: pointer;
        transition: all 0.2s ease;
        font-family: inherit;
        letter-spacing: -0.3px;
    }

    /* è®¾ç½®é¡¹æ‚¬åœæ•ˆæœ */
    .settings-item:hover {
        background-color: var(--ios-background);
    }

    /* è®¾ç½®é¡¹æ¿€æ´»çŠ¶æ€ */
    .settings-item.active {
        background-color: rgba(0, 122, 255, 0.1);
        color: var(--ios-primary);
        font-weight: 600;
    }

    /* å³ä¾§è®¾ç½®å†…å®¹åŒº */
    .settings-content {
        flex: 1;
        padding: 24px;
        overflow-y: auto;
        background: var(--ios-background);
    }

    /* è®¾ç½®å†…å®¹å¡ç‰‡ */
    .settings-section {
        background: var(--ios-card);
        padding: 24px;
        border-radius: var(--ios-corner-large);
        box-shadow: var(--ios-shadow-sm);
        margin-bottom: 24px;
    }

    /* è®¾ç½®å†…å®¹æ ‡é¢˜ */
    .settings-section h3 {
        font-size: 20px;
        margin-bottom: 20px;
        color: var(--ios-text-primary);
        font-weight: 700;
        letter-spacing: -0.4px;
    }
    </style>
</head>
<body>
    <!-- è®¤è¯ç•Œé¢ï¼ˆç™»å½•/è®¾ç½®ï¼‰ -->
    <div id="authScreen" class="auth-container">
        <h1 class="auth-title">PassBox</h1>
        <p class="auth-subtitle">æœ¬åœ°å¯†ç ç®¡ç†å™¨</p>
        
        <!-- ç™»å½•è¡¨å• -->
        <div id="loginForm">
            <h2 class="auth-title">ç™»å½•</h2>
            <div class="form-group">
                <label for="loginPassword">ä¸»å¯†ç </label>
                <input type="password" id="loginPassword" placeholder="è¯·è¾“å…¥ä¸»å¯†ç " required>
            </div>
            <div class="error-message" id="loginError"></div>
            <button class="btn btn-login" onclick="handleLogin()">ç™»å½•</button>
            <button class="btn btn-forgot" onclick="handleForgotPassword()">å¿˜è®°ä¸»å¯†ç </button>
        </div>
    </div>

    <!-- ä¸»å¯†ç è®¾ç½®ç•Œé¢ -->
    <div id="setupScreen" class="auth-container">
        <h1 class="auth-title">PassBox</h1>
        <p class="auth-subtitle">æœ¬åœ°å¯†ç ç®¡ç†å™¨</p>
        <h2 class="auth-title">è®¾ç½®ä¸»å¯†ç </h2>
        <p class="auth-subtitle">è¯·è®¾ç½®ä¸€ä¸ªå¼ºä¸»å¯†ç æ¥ä¿æŠ¤æ‚¨çš„å¯†ç åº“</p>
        
        <div class="form-group">
            <label for="setupPassword">ä¸»å¯†ç </label>
            <input type="password" id="setupPassword" placeholder="è¯·è¾“å…¥ä¸»å¯†ç " required>
        </div>
        <div class="form-group">
            <label for="confirmPassword">ç¡®è®¤ä¸»å¯†ç </label>
            <input type="password" id="confirmPassword" placeholder="è¯·å†æ¬¡è¾“å…¥ä¸»å¯†ç " required>
        </div>
        <div class="error-message" id="setupError"></div>
        <button class="btn btn-setup" onclick="handleSetup()">è®¾ç½®ä¸»å¯†ç </button>
    </div>

    <!-- å¯†ç ç®¡ç†å™¨ä¸»ç•Œé¢ -->
    <div id="passwordManagerScreen" class="container">
        <header>
            <h1>PassBox - æœ¬åœ°å¯†ç ç®¡ç†å™¨</h1>
            <!-- è®¾ç½®æŒ‰é’® -->
            <button class="btn btn-small" onclick="showSettingsScreen()" style="position: absolute; right: 20px; top: 16px;">
                <span class="btn-icon">âš™ï¸</span> è®¾ç½®
            </button>
            <!-- iOS å¯¼èˆªæ æŒ‰é’®å®¹å™¨ -->
            <div style="margin-top: 16px; display: flex; gap: 12px; justify-content: center; padding: 0 20px;">
                <button class="btn btn-success btn-small" onclick="showAddPasswordScreen()">
                     æ·»åŠ æ–°å¯†ç 
                </button>
                <button class="btn btn-primary btn-small" onclick="showSavedPasswordsScreen()">
                     æŸ¥çœ‹å·²ä¿å­˜å¯†ç 
                </button>
                <button class="btn btn-secondary btn-small" onclick="lockApplication()">
                     <span class="btn-icon">ğŸ”’</span> åº”ç”¨é”å®š
                </button>
            </div>
        </header>
        <div class="content">
            
            <!-- æ·»åŠ æ–°å¯†ç ç•Œé¢ -->
            <div id="addPasswordScreen" style="display: block; overflow: hidden; height: 100%; flex: 1;">
                <div class="form-section" style="height: 100%; display: flex; flex-direction: column;">
                    <h2>æ·»åŠ æ–°å¯†ç </h2>
                    <form id="passwordForm" style="flex: 1; overflow-y: auto;">
                        <div class="form-group">
                            <label for="service">æœåŠ¡åç§°</label>
                            <input type="text" id="service" name="service" required placeholder="ä¾‹å¦‚ï¼šGitHubã€å¾®ä¿¡">
                        </div>
                        <div class="form-group">
                            <label for="username">ç”¨æˆ·å/é‚®ç®±</label>
                            <input type="text" id="username" name="username" required placeholder="è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±">
                        </div>
                        <div class="form-group">
                            <label for="password">å¯†ç </label>
                            <input type="password" id="password" name="password" required placeholder="è¾“å…¥å¯†ç ">
                        </div>
                        
                        <!-- äºŒæ¬¡å®‰å…¨éªŒè¯è®¾ç½® -->
                        <div class="form-group">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <label for="enableSecondaryAuth">å¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯</label>
                                <input type="checkbox" id="enableSecondaryAuth" name="enableSecondaryAuth" style="width: auto;">
                            </div>
                        </div>
                        
                        <div class="form-group" id="secondaryPasswordGroup" style="display: none;">
                            <label for="secondaryPassword">äºŒæ¬¡å®‰å…¨å¯†ç </label>
                            <input type="password" id="secondaryPassword" name="secondaryPassword" placeholder="è®¾ç½®äºŒæ¬¡å®‰å…¨å¯†ç ">
                        </div>
                    </form>
                    <!-- ä¿å­˜å¯†ç æŒ‰é’®ï¼Œå›ºå®šåœ¨åº•éƒ¨ -->
                    <button type="submit" form="passwordForm" class="btn btn-primary" style="width: 100%; margin-top: 16px;">ä¿å­˜å¯†ç </button>
                </div>
            </div>

            <!-- å·²ä¿å­˜å¯†ç ç•Œé¢ -->
            <div id="savedPasswordsScreen" style="display: none; overflow: hidden; height: 100%; flex: 1;">
                <div class="passwords-section" style="height: 100%;">
                    <div id="passwordsList" style="overflow-y: auto; height: 100%;"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- è®¾ç½®ç•Œé¢ -->
    <div id="settingsScreen" style="display: none; height: 100vh; overflow: hidden; background-color: var(--ios-background);">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <div style="background: var(--ios-card); border-bottom: 1px solid var(--ios-gray-light); padding: 0 24px; overflow-x: auto;">
            <div style="display: flex; gap: 0; min-width: max-content; align-items: center;">
                <!-- è¿”å›æŒ‰é’® -->
                <button onclick="showPasswordManagerScreen()" style="padding: 16px; border: none; background: transparent; font-size: 18px; color: var(--ios-primary); margin-right: 16px; min-width: auto;">â†</button>
                <!-- æ ‡ç­¾å¯¼èˆª -->
                <div style="display: flex; gap: 0; flex: 1;">
                    <button class="settings-tab active" onclick="showSetting('appearance')" style="padding: 16px 24px; border: none; background: transparent; font-size: 16px; color: var(--ios-primary); font-weight: 600; border-bottom: 2px solid var(--ios-primary); flex: 1; min-width: 120px;">å¤–è§‚è®¾ç½®</button>
                    <button class="settings-tab" onclick="showSetting('security')" style="padding: 16px 24px; border: none; background: transparent; font-size: 16px; color: var(--ios-text-secondary); border-bottom: 2px solid transparent; flex: 1; min-width: 120px;">å®‰å…¨è®¾ç½®</button>
                    <button class="settings-tab" onclick="showSetting('about')" style="padding: 16px 24px; border: none; background: transparent; font-size: 16px; color: var(--ios-text-secondary); border-bottom: 2px solid transparent; flex: 1; min-width: 120px;">å…³äº</button>
                </div>
                <!-- é”å®šæŒ‰é’® -->
                <button class="btn btn-small" onclick="lockApplication()" style="margin-left: 16px; padding: 8px 16px; min-width: auto;">
                    <span class="btn-icon">ğŸ”’</span> é”å®š
                </button>
            </div>
        </div>
        
        <!-- è®¾ç½®å†…å®¹åŒºåŸŸ -->
        <div style="padding: 24px; height: calc(100vh - 60px); overflow-y: auto;">
            <!-- å¤–è§‚è®¾ç½® -->
            <div id="appearanceSetting" class="settings-content-panel" style="display: block;">
                <div style="background: var(--ios-card); border-radius: var(--ios-corner-large); padding: 24px; box-shadow: var(--ios-shadow-sm);">
                    <h3 style="margin-bottom: 24px; font-size: 20px; font-weight: 700;">å¤–è§‚è®¾ç½®</h3>
                    
                    <!-- è‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡è®¾ç½® -->
                    <div style="margin-bottom: 24px;">
                        <label for="customBackground" style="display: block; margin-bottom: 12px; font-weight: 500;">è‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡</label>
                        <input type="file" id="customBackground" name="customBackground" accept="image/*" style="width: 100%; padding: 8px; border: 1px solid var(--ios-gray-light); border-radius: var(--ios-corner-medium); background: var(--ios-background);">
                        <p style="margin-top: 8px; font-size: 14px; color: var(--ios-text-secondary);">é€‰æ‹©ä¸€å¼ å›¾ç‰‡ä½œä¸ºåº”ç”¨èƒŒæ™¯ <span id="appAspectRatio" style="margin-left: 8px; color: var(--ios-primary); font-weight: 500;"></span></p>
                    </div>
                    
                    <!-- èƒŒæ™¯é¢„è§ˆ -->
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; margin-bottom: 12px; font-weight: 500;">èƒŒæ™¯é¢„è§ˆ</label>
                        <div id="backgroundPreview" style="width: 100%; height: 200px; background-color: var(--ios-background); border-radius: var(--ios-corner-medium); margin-top: 8px; display: flex; justify-content: center; align-items: center; border: 1px solid var(--ios-gray-light);">
                            <span style="color: var(--ios-text-tertiary);">å½“å‰æ— è‡ªå®šä¹‰èƒŒæ™¯</span>
                        </div>
                    </div>
                    
                    <!-- é€æ˜åº¦è®¾ç½® -->
                    <div style="margin-bottom: 24px;">
                        <label style="display: block; margin-bottom: 12px; font-weight: 500;">ç•Œé¢é€æ˜åº¦</label>
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <input type="range" id="opacitySlider" min="0" max="100" value="100" step="1" style="flex: 1; padding: 8px 0; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                            <input type="number" id="opacityInput" min="0" max="100" value="100" style="width: 80px; padding: 8px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px; text-align: center;">
                            <span id="opacityValue" style="min-width: 50px; font-weight: 600; color: var(--ios-primary);">100%</span>
                        </div>
                        <div id="opacityPreview" style="width: 100%; height: 100px; background-color: var(--ios-card); border-radius: var(--ios-corner-medium); margin-top: 12px; display: flex; justify-content: center; align-items: center; border: 1px solid var(--ios-gray-light); transition: opacity 0.3s ease;">
                            <div style="background: var(--ios-background); padding: 20px; border-radius: var(--ios-corner-medium); width: 80%;">
                                <p style="margin: 0; text-align: center; color: var(--ios-text-primary);">é€æ˜åº¦é¢„è§ˆ</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ä¿å­˜å’Œé‡ç½®æŒ‰é’® -->
                    <div style="display: flex; gap: 12px;">
                        <button class="btn btn-primary" onclick="saveSettings()" style="width: auto; min-width: 120px;">ä¿å­˜è®¾ç½®</button>
                        <button class="btn btn-secondary" onclick="resetBackground()" style="width: auto; min-width: 120px;">é‡ç½®ä¸ºé»˜è®¤èƒŒæ™¯</button>
                    </div>
                </div>
            </div>
            
            <!-- å®‰å…¨è®¾ç½® -->
            <div id="securitySetting" class="settings-content-panel" style="display: none;">
                <div style="background: var(--ios-card); border-radius: var(--ios-corner-large); padding: 24px; box-shadow: var(--ios-shadow-sm);">
                    <h3 style="margin-bottom: 24px; font-size: 20px; font-weight: 700;">å®‰å…¨è®¾ç½®</h3>
                    
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--ios-gray-light);">
                            <span style="font-size: 16px;">è‡ªåŠ¨é”å®šæ—¶é—´</span>
                            <select style="padding: 8px 12px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                                <option>1åˆ†é’Ÿ</option>
                                <option>5åˆ†é’Ÿ</option>
                                <option>10åˆ†é’Ÿ</option>
                                <option>30åˆ†é’Ÿ</option>
                                <option>1å°æ—¶</option>
                                <option>ä»ä¸</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--ios-gray-light);">
                            <span style="font-size: 16px;">å¯ç”¨è‡ªåŠ¨å¤‡ä»½</span>
                            <input type="checkbox" style="width: 20px; height: 20px; accent-color: var(--ios-primary);">
                        </div>
                        
                        <!-- æœ€å°åŒ–è‡ªåŠ¨é”å®šè®¾ç½® -->
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--ios-gray-light);">
                            <span style="font-size: 16px;">æœ€å°åŒ–æ—¶è‡ªåŠ¨é”å®š</span>
                            <input type="checkbox" id="enableMinimizeLock" style="width: 20px; height: 20px; accent-color: var(--ios-primary);">
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0; border-bottom: 1px solid var(--ios-gray-light);">
                            <span style="font-size: 16px;">æœ€å°åŒ–é”å®šå»¶è¿Ÿ</span>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <select id="minimizeLockDelay" style="padding: 8px 12px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                                    <option value="0">ç«‹å³é”å®š</option>
                                    <option value="30000">30ç§’</option>
                                    <option value="60000">1åˆ†é’Ÿ</option>
                                    <option value="300000">5åˆ†é’Ÿ</option>
                                    <option value="600000">10åˆ†é’Ÿ</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- å®‰å…¨é—®é¢˜è®¾ç½® -->
                    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--ios-gray-light);">
                        <h4 style="margin-bottom: 16px; font-size: 16px; font-weight: 600;">å®‰å…¨é—®é¢˜è®¾ç½®</h4>
                        <div style="margin-bottom: 16px;">
                            <label for="securityQuestionSelect" style="display: block; margin-bottom: 8px; font-weight: 500;">é€‰æ‹©å®‰å…¨é—®é¢˜</label>
                            <select id="securityQuestionSelect" style="width: 100%; padding: 8px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                                <option value="">-- è¯·é€‰æ‹©å®‰å…¨é—®é¢˜ --</option>
                                <option value="æ‚¨çš„å‡ºç”ŸåŸå¸‚æ˜¯ï¼Ÿ">æ‚¨çš„å‡ºç”ŸåŸå¸‚æ˜¯ï¼Ÿ</option>
                                <option value="æ‚¨çš„æ¯äº²çš„å§“åæ˜¯ï¼Ÿ">æ‚¨çš„æ¯äº²çš„å§“åæ˜¯ï¼Ÿ</option>
                                <option value="æ‚¨ç¬¬ä¸€åªå® ç‰©çš„åå­—æ˜¯ï¼Ÿ">æ‚¨ç¬¬ä¸€åªå® ç‰©çš„åå­—æ˜¯ï¼Ÿ</option>
                                <option value="æ‚¨æœ€å–œæ¬¢çš„é¢œè‰²æ˜¯ï¼Ÿ">æ‚¨æœ€å–œæ¬¢çš„é¢œè‰²æ˜¯ï¼Ÿ</option>
                                <option value="æ‚¨çš„å°å­¦åç§°æ˜¯ï¼Ÿ">æ‚¨çš„å°å­¦åç§°æ˜¯ï¼Ÿ</option>
                                <option value="æ‚¨æœ€å–œæ¬¢çš„ç”µå½±æ˜¯ï¼Ÿ">æ‚¨æœ€å–œæ¬¢çš„ç”µå½±æ˜¯ï¼Ÿ</option>
                                <option value="æ‚¨æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯ï¼Ÿ">æ‚¨æœ€å–œæ¬¢çš„é£Ÿç‰©æ˜¯ï¼Ÿ</option>
                            </select>
                        </div>
                        <div style="margin-bottom: 16px;">
                            <label for="securityQuestionAnswer" style="display: block; margin-bottom: 8px; font-weight: 500;">å®‰å…¨é—®é¢˜ç­”æ¡ˆ</label>
                            <input type="text" id="securityQuestionAnswer" placeholder="è¯·è¾“å…¥å®‰å…¨é—®é¢˜ç­”æ¡ˆ" style="width: 100%; padding: 10px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                        </div>
                        <div id="currentSecurityQuestion" style="margin-bottom: 16px; padding: 12px; background-color: var(--ios-background); border-radius: var(--ios-corner-medium); display: none;">
                            <p style="margin: 0; font-size: 14px; color: var(--ios-text-secondary);">
                                å·²è®¾ç½®çš„å®‰å…¨é—®é¢˜ï¼š<strong id="currentQuestionText"></strong>
                            </p>
                        </div>
                        <button class="btn btn-primary" onclick="saveSecurityQuestion()" style="width: auto; min-width: 120px;">ä¿å­˜å®‰å…¨é—®é¢˜</button>
                    </div>
                    
                    <!-- ä¿å­˜è®¾ç½®æŒ‰é’® -->
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-primary" onclick="saveSettings()" style="width: auto; min-width: 120px;">ä¿å­˜è®¾ç½®</button>
                    </div>
                </div>
            </div>
            
            <!-- å…³äº -->
            <div id="aboutSetting" class="settings-content-panel" style="display: none;">
                <div style="background: var(--ios-card); border-radius: var(--ios-corner-large); padding: 24px; box-shadow: var(--ios-shadow-sm);">
                    <h3 style="margin-bottom: 24px; font-size: 20px; font-weight: 700;">å…³äº PassBox</h3>
                    
                    <div style="margin-bottom: 24px;">
                        <p style="margin-bottom: 8px; font-size: 16px;">ç‰ˆæœ¬ï¼š1.0.2</p>
                        <p style="font-size: 16px; color: var(--ios-text-secondary);">æœ¬åœ°å¯†ç ç®¡ç†å™¨ï¼Œå®‰å…¨å¯é </p>
                    </div>
                    
                    <div style="padding: 16px; background-color: var(--ios-background); border-radius: var(--ios-corner-medium);">
                        <p style="font-size: 14px; color: var(--ios-text-secondary); line-height: 1.6;">
                            PassBox æ˜¯ä¸€æ¬¾æœ¬åœ°å¯†ç ç®¡ç†å™¨ï¼Œæ‰€æœ‰æ•°æ®å‡å­˜å‚¨åœ¨æ‚¨çš„è®¾å¤‡ä¸Šï¼Œç¡®ä¿æ‚¨çš„å¯†ç å®‰å…¨å¯é ã€‚
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å®‰å…¨é—®é¢˜éªŒè¯ç•Œé¢ -->
    <div id="securityQuestionVerificationScreen" style="display: none; height: 100vh; overflow: hidden; background-color: var(--ios-background);">
        <div style="display: flex; flex-direction: column; height: 100%; max-width: 400px; margin: 0 auto; padding: 20px;">
            <h2 style="text-align: center; margin-bottom: 24px; font-size: 24px; font-weight: 700;">éªŒè¯å®‰å…¨é—®é¢˜</h2>
            
            <div style="background: var(--ios-card); border-radius: var(--ios-corner-large); padding: 24px; box-shadow: var(--ios-shadow-sm); margin-bottom: 20px;">
                <p style="margin-bottom: 16px; color: var(--ios-text-secondary);">
                    è¯·å›ç­”æ‚¨è®¾ç½®çš„å®‰å…¨é—®é¢˜ï¼ŒéªŒè¯é€šè¿‡åå¯ä»¥ä¿®æ”¹ä¸»å¯†ç ã€‚
                </p>
                <div style="margin-bottom: 16px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500;">å®‰å…¨é—®é¢˜</label>
                    <div id="verificationQuestion" style="padding: 12px; background-color: var(--ios-background); border-radius: var(--ios-corner-medium); font-weight: 600; margin-bottom: 8px;"></div>
                </div>
                <div style="margin-bottom: 16px;">
                    <label for="verificationAnswer" style="display: block; margin-bottom: 8px; font-weight: 500;">ç­”æ¡ˆ</label>
                    <input type="text" id="verificationAnswer" placeholder="è¯·è¾“å…¥æ‚¨çš„ç­”æ¡ˆ" style="width: 100%; padding: 10px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                </div>
                <div id="verificationError" style="margin-bottom: 16px; padding: 12px; background-color: #FFF3CD; border: 1px solid #FFEEBA; border-radius: var(--ios-corner-medium); display: none;">
                    <p style="color: #856404; margin: 0; font-size: 14px;"></p>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="verifySecurityQuestionAnswer()" style="width: 100%; margin-bottom: 12px;">éªŒè¯ç­”æ¡ˆ</button>
            <button class="btn btn-secondary" onclick="showLoginScreen()" style="width: 100%;">è¿”å›ç™»å½•</button>
        </div>
    </div>
    
    <!-- ä¿®æ”¹ä¸»å¯†ç ç•Œé¢ -->
    <div id="resetMasterPasswordScreen" style="display: none; height: 100vh; overflow: hidden; background-color: var(--ios-background);">
        <div style="display: flex; flex-direction: column; height: 100%; max-width: 400px; margin: 0 auto; padding: 20px;">
            <h2 style="text-align: center; margin-bottom: 24px; font-size: 24px; font-weight: 700;">ä¿®æ”¹ä¸»å¯†ç </h2>
            
            <div style="background: var(--ios-card); border-radius: var(--ios-corner-large); padding: 24px; box-shadow: var(--ios-shadow-sm); margin-bottom: 20px;">
                <p style="margin-bottom: 16px; color: var(--ios-text-secondary);">
                    å®‰å…¨é—®é¢˜éªŒè¯é€šè¿‡ï¼Œè¯·è®¾ç½®æ–°çš„ä¸»å¯†ç ã€‚
                </p>
                <div style="margin-bottom: 16px;">
                    <label for="newMasterPassword" style="display: block; margin-bottom: 8px; font-weight: 500;">æ–°ä¸»å¯†ç </label>
                    <input type="password" id="newMasterPassword" placeholder="è¯·è¾“å…¥æ–°ä¸»å¯†ç ï¼ˆè‡³å°‘8ä½ï¼‰" style="width: 100%; padding: 10px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                </div>
                <div style="margin-bottom: 16px;">
                    <label for="confirmNewMasterPassword" style="display: block; margin-bottom: 8px; font-weight: 500;">ç¡®è®¤æ–°ä¸»å¯†ç </label>
                    <input type="password" id="confirmNewMasterPassword" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°ä¸»å¯†ç " style="width: 100%; padding: 10px; border-radius: var(--ios-corner-medium); border: 1px solid var(--ios-gray-light); background: var(--ios-background); font-size: 14px;">
                </div>
                <div id="resetPasswordError" style="margin-bottom: 16px; padding: 12px; background-color: #FFF3CD; border: 1px solid #FFEEBA; border-radius: var(--ios-corner-medium); display: none;">
                    <p style="color: #856404; margin: 0; font-size: 14px;"></p>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="resetMasterPassword()" style="width: 100%; margin-bottom: 12px;">ç¡®è®¤ä¿®æ”¹</button>
            <button class="btn btn-secondary" onclick="showLoginScreen()" style="width: 100%;">è¿”å›ç™»å½•</button>
        </div>
    </div>
    
    <script>
        // ç•Œé¢å…ƒç´ 
        const authScreen = document.getElementById('authScreen');
        const setupScreen = document.getElementById('setupScreen');
        const passwordManagerScreen = document.getElementById('passwordManagerScreen');
        const settingsScreen = document.getElementById('settingsScreen');
        const addPasswordScreen = document.getElementById('addPasswordScreen');
        const savedPasswordsScreen = document.getElementById('savedPasswordsScreen');
        const loginError = document.getElementById('loginError');
        const setupError = document.getElementById('setupError');

        // å¯†ç ç®¡ç†å…ƒç´ 
        const form = document.getElementById('passwordForm');
        const passwordsList = document.getElementById('passwordsList');

        document.addEventListener('DOMContentLoaded', async () => {
            // åˆå§‹åŒ–æ‰€æœ‰ç•Œé¢çŠ¶æ€
            initializeAllScreens();
            
            // æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®ä¸»å¯†ç 
            const isSetup = await window.passwordManager.checkMasterPasswordSetup();
            
            if (isSetup) {
                // å·²è®¾ç½®ï¼Œæ˜¾ç¤ºç™»å½•ç•Œé¢
                authScreen.style.display = 'block';
            } else {
                // æœªè®¾ç½®ï¼Œæ˜¾ç¤ºè®¾ç½®ç•Œé¢
                setupScreen.style.display = 'block';
            }
        });
        
        // åˆå§‹åŒ–æ‰€æœ‰ç•Œé¢çŠ¶æ€
        function initializeAllScreens() {
            // ç¡®ä¿æ‰€æœ‰ç•Œé¢éƒ½åœ¨æ­£ç¡®çš„åˆå§‹çŠ¶æ€
            passwordManagerScreen.style.display = 'none';
            settingsScreen.style.display = 'none';
            addPasswordScreen.style.display = 'none';
            savedPasswordsScreen.style.display = 'none';
            
            // ç¡®ä¿å¿˜è®°å¯†ç ç›¸å…³ç•Œé¢æ˜¯éšè—çš„
            const securityQuestionVerificationScreen = document.getElementById('securityQuestionVerificationScreen');
            if (securityQuestionVerificationScreen) {
                securityQuestionVerificationScreen.style.display = 'none';
            }
            
            const resetMasterPasswordScreen = document.getElementById('resetMasterPasswordScreen');
            if (resetMasterPasswordScreen) {
                resetMasterPasswordScreen.style.display = 'none';
            }
            
            // ç¡®ä¿è®¾ç½®é¡¹å†…å®¹æ˜¯éšè—çš„
            const settingContents = document.querySelectorAll('[id$="Setting"]');
            settingContents.forEach(content => {
                content.style.display = 'none';
            });
            
            console.log('ğŸ” æ‰€æœ‰ç•Œé¢å·²åˆå§‹åŒ–ä¸ºéšè—çŠ¶æ€');
        }

        // å¤„ç†ä¸»å¯†ç è®¾ç½®
        async function handleSetup() {
            const password = document.getElementById('setupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // éªŒè¯å¯†ç 
            if (password.length < 8) {
                setupError.textContent = 'ä¸»å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä¸ªå­—ç¬¦';
                return;
            }
            
            if (password !== confirmPassword) {
                setupError.textContent = 'ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´';
                return;
            }
            
            try {
                await window.passwordManager.setupMasterPassword(password);
                // è®¾ç½®æˆåŠŸï¼Œåˆ‡æ¢åˆ°å¯†ç ç®¡ç†ç•Œé¢
                setupScreen.style.display = 'none';
                passwordManagerScreen.style.display = 'block';
                // é»˜è®¤æ˜¾ç¤ºå·²ä¿å­˜å¯†ç ç•Œé¢
                await showSavedPasswordsScreen();
            } catch (error) {
                setupError.textContent = 'è®¾ç½®å¤±è´¥ï¼š' + error.message;
            }
        }

        // å¯¼èˆªå‡½æ•°ï¼šæ˜¾ç¤ºæ·»åŠ æ–°å¯†ç ç•Œé¢
        function showAddPasswordScreen() {
            addPasswordScreen.style.display = 'block';
            savedPasswordsScreen.style.display = 'none';
        }

        // å¯¼èˆªå‡½æ•°ï¼šæ˜¾ç¤ºå·²ä¿å­˜å¯†ç ç•Œé¢
        async function showSavedPasswordsScreen() {
            addPasswordScreen.style.display = 'none';
            savedPasswordsScreen.style.display = 'block';
            // åŠ è½½æœ€æ–°çš„å¯†ç åˆ—è¡¨
            await loadPasswords();
        }
        
        // å¯¼èˆªå‡½æ•°ï¼šæ˜¾ç¤ºå¯†ç ç®¡ç†å™¨ä¸»ç•Œé¢
        function showPasswordManagerScreen() {
            settingsScreen.style.display = 'none';
            passwordManagerScreen.style.display = 'block';
        }
        
        // å¯¼èˆªå‡½æ•°ï¼šæ˜¾ç¤ºè®¾ç½®ç•Œé¢
        function showSettingsScreen() {
            passwordManagerScreen.style.display = 'none';
            settingsScreen.style.display = 'block';
            
            // é»˜è®¤æ˜¾ç¤ºå¤–è§‚è®¾ç½®
            showSetting('appearance');
        }
        
        // å¯¼èˆªå‡½æ•°ï¼šæ˜¾ç¤ºç‰¹å®šè®¾ç½®é¡¹
        function showSetting(settingName) {
            // æ›´æ–°é¡¶éƒ¨æ ‡ç­¾æ¿€æ´»çŠ¶æ€
            const settingTabs = document.querySelectorAll('.settings-tab');
            settingTabs.forEach(tab => {
                tab.classList.remove('active');
                tab.style.color = 'var(--ios-text-secondary)';
                tab.style.borderBottom = '2px solid transparent';
            });
            
            // æ‰¾åˆ°å¯¹åº”çš„æ ‡ç­¾å¹¶æ¿€æ´»
            const targetTab = document.querySelector(`[onclick="showSetting('${settingName}')"]`);
            if (targetTab) {
                targetTab.classList.add('active');
                targetTab.style.color = 'var(--ios-primary)';
                targetTab.style.borderBottom = '2px solid var(--ios-primary)';
            }
            
            // åˆ‡æ¢å†…å®¹æ˜¾ç¤º
            const settingContents = document.querySelectorAll('[id$="Setting"]');
            settingContents.forEach(content => {
                content.style.display = 'none';
            });
            
            const targetContent = document.getElementById(`${settingName}Setting`);
            if (targetContent) {
                targetContent.style.display = 'block';
            }
            
            // å¦‚æœåˆ‡æ¢åˆ°å®‰å…¨è®¾ç½®ï¼ŒåŠ è½½å½“å‰å®‰å…¨é—®é¢˜
            if (settingName === 'security') {
                loadCurrentSecurityQuestion();
            }
        }
        
        // åº”ç”¨é”å®šåŠŸèƒ½
        function lockApplication() {
            // è®°å½•é”å®šæ—¥å¿—
            logLockEvent();
            
            // æ¸…é™¤æ‰€æœ‰ä¼šè¯æ•°æ®å’Œä¸´æ—¶å­˜å‚¨çš„è®¤è¯ä¿¡æ¯
            clearSessionData();
            
            // é‡ç½®æ‰€æœ‰ç•Œé¢çŠ¶æ€
            resetAllScreens();
            
            // é‡å®šå‘åˆ°ç™»å½•ç•Œé¢
            showLoginScreen();
        }
        
        // è®°å½•é”å®šäº‹ä»¶
        function logLockEvent() {
            // è®°å½•é”å®šæ—¶é—´å’Œä¸Šä¸‹æ–‡ä¿¡æ¯
            const lockTime = new Date().toISOString();
            const currentScreen = getCurrentScreen();
            const lockLog = {
                timestamp: lockTime,
                event: 'application_locked',
                currentScreen: currentScreen,
                userAgent: navigator.userAgent
            };
            
            // ç®€å•çš„æ—¥å¿—è®°å½•ï¼Œå®é™…é¡¹ç›®ä¸­å¯ä»¥è€ƒè™‘æ›´å¤æ‚çš„æ—¥å¿—ç³»ç»Ÿ
            console.log('ğŸ”’ åº”ç”¨é”å®šäº‹ä»¶:', lockLog);
            
            // å¯ä»¥é€‰æ‹©å°†æ—¥å¿—å­˜å‚¨åˆ°localStorageæˆ–å…¶ä»–æŒä¹…åŒ–å­˜å‚¨ä¸­
            try {
                const logs = JSON.parse(localStorage.getItem('lockLogs') || '[]');
                logs.push(lockLog);
                // åªä¿ç•™æœ€è¿‘100æ¡æ—¥å¿—
                if (logs.length > 100) {
                    logs.shift();
                }
                localStorage.setItem('lockLogs', JSON.stringify(logs));
            } catch (error) {
                console.error('ä¿å­˜é”å®šæ—¥å¿—å¤±è´¥:', error);
            }
        }
        
        // æ¸…é™¤ä¼šè¯æ•°æ®
        function clearSessionData() {
            // è¿™é‡Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¸…é™¤æ›´å¤šä¼šè¯æ•°æ®
            // ä¾‹å¦‚ï¼šæ¸…é™¤è¡¨å•æ•°æ®ã€æ¸…é™¤ä¸´æ—¶å­˜å‚¨çš„å¯†ç ç­‰
            
            // æ¸…é™¤è¡¨å•æ•°æ®
            const passwordForm = document.getElementById('passwordForm');
            if (passwordForm) {
                passwordForm.reset();
            }
            
            // æ¸…é™¤ç™»å½•è¡¨å•æ•°æ®
            const loginPassword = document.getElementById('loginPassword');
            if (loginPassword) {
                loginPassword.value = '';
            }
            
            // æ¸…é™¤è®¾ç½®è¡¨å•æ•°æ®
            const customBackground = document.getElementById('customBackground');
            if (customBackground) {
                customBackground.value = '';
            }
            
            // è°ƒç”¨åç«¯é”å®šæ¥å£ï¼ˆå¦‚æœæœ‰ï¼‰
            try {
                if (window.passwordManager && window.passwordManager.lock) {
                    window.passwordManager.lock();
                }
            } catch (error) {
                console.error('è°ƒç”¨é”å®šæ¥å£å¤±è´¥:', error);
            }
        }
        
        // é‡ç½®æ‰€æœ‰ç•Œé¢çŠ¶æ€
        function resetAllScreens() {
            // éšè—æ‰€æœ‰ç•Œé¢
            passwordManagerScreen.style.display = 'none';
            settingsScreen.style.display = 'none';
            
            // éšè—å¿˜è®°å¯†ç ç›¸å…³ç•Œé¢
            const securityQuestionVerificationScreen = document.getElementById('securityQuestionVerificationScreen');
            if (securityQuestionVerificationScreen) {
                securityQuestionVerificationScreen.style.display = 'none';
            }
            
            const resetMasterPasswordScreen = document.getElementById('resetMasterPasswordScreen');
            if (resetMasterPasswordScreen) {
                resetMasterPasswordScreen.style.display = 'none';
            }
            
            // éšè—è®¾ç½®é¡¹å†…å®¹
            const settingContents = document.querySelectorAll('[id$="Setting"]');
            settingContents.forEach(content => {
                content.style.display = 'none';
            });
            
            // é‡ç½®è®¾ç½®æ ‡ç­¾çŠ¶æ€
            const settingTabs = document.querySelectorAll('.settings-tab');
            settingTabs.forEach(tab => {
                tab.classList.remove('active');
                tab.style.color = 'var(--ios-text-secondary)';
                tab.style.borderBottom = '2px solid transparent';
            });
        }
        
        // æ˜¾ç¤ºç™»å½•ç•Œé¢
        function showLoginScreen() {
            // æ˜¾ç¤ºç™»å½•ç•Œé¢
            authScreen.style.display = 'block';
            setupScreen.style.display = 'none';
            
            // éšè—å¿˜è®°å¯†ç ç›¸å…³ç•Œé¢
            const securityQuestionVerificationScreen = document.getElementById('securityQuestionVerificationScreen');
            if (securityQuestionVerificationScreen) {
                securityQuestionVerificationScreen.style.display = 'none';
            }
            
            const resetMasterPasswordScreen = document.getElementById('resetMasterPasswordScreen');
            if (resetMasterPasswordScreen) {
                resetMasterPasswordScreen.style.display = 'none';
            }
            
            // ç¡®ä¿ç™»å½•é”™è¯¯ä¿¡æ¯å·²æ¸…é™¤
            const loginError = document.getElementById('loginError');
            if (loginError) {
                loginError.textContent = '';
            }
        }
        
        // è·å–å½“å‰å±å¹•
        function getCurrentScreen() {
            if (passwordManagerScreen.style.display === 'block') {
                if (addPasswordScreen.style.display === 'block') {
                    return 'add_password_screen';
                } else if (savedPasswordsScreen.style.display === 'block') {
                    return 'saved_passwords_screen';
                }
            } else if (settingsScreen.style.display === 'block') {
                return 'settings_screen';
            }
            return 'unknown_screen';
        }
        
        // ä¿å­˜è®¾ç½®
        function saveSettings() {
            // è·å–æ‰€æœ‰è®¾ç½®é¡¹
            const settings = {
                // å¤–è§‚è®¾ç½®
                appearance: {
                    customBackground: null
                },
                // å®‰å…¨è®¾ç½®
                security: {
                    autoLockTime: '1åˆ†é’Ÿ', // é»˜è®¤å€¼
                    enableAutoBackup: false // é»˜è®¤å€¼
                }
            };
            
            // å¤„ç†å¤–è§‚è®¾ç½®
            const customBackgroundInput = document.getElementById('customBackground');
            if (customBackgroundInput && customBackgroundInput.files[0]) {
                const file = customBackgroundInput.files[0];
                const reader = new FileReader();
                reader.onload = (event) => {
                    settings.appearance.customBackground = {
                        url: event.target.result,
                        size: 'cover',
                        applied: true
                    };
                    
                    // åº”ç”¨èƒŒæ™¯åˆ°é¡µé¢
                    document.body.style.backgroundImage = `url(${event.target.result})`;
                    document.body.style.backgroundSize = 'cover';
                    document.body.style.backgroundPosition = 'center';
                    document.body.style.backgroundRepeat = 'no-repeat';
                    document.body.style.backgroundAttachment = 'fixed';
                    
                    // ä¿å­˜æ‰€æœ‰è®¾ç½®
                    saveAllSettings(settings);
                };
                reader.readAsDataURL(file);
            } else {
                // ä¿å­˜æ‰€æœ‰è®¾ç½®ï¼ˆä¸åŒ…å«èƒŒæ™¯å›¾ç‰‡ï¼‰
                saveAllSettings(settings);
            }
        }
        
        // ä¿å­˜æ‰€æœ‰è®¾ç½®åˆ°localStorage
        function saveAllSettings(settings) {
            // è·å–å®‰å…¨è®¾ç½®
            const autoLockTimeSelect = document.querySelector('#securitySetting select');
            const enableAutoBackupCheckbox = document.querySelector('#securitySetting input[type="checkbox"]');
            const enableMinimizeLockCheckbox = document.getElementById('enableMinimizeLock');
            const minimizeLockDelaySelect = document.getElementById('minimizeLockDelay');
            
            if (autoLockTimeSelect) {
                settings.security.autoLockTime = autoLockTimeSelect.value;
            }
            
            if (enableAutoBackupCheckbox) {
                settings.security.enableAutoBackup = enableAutoBackupCheckbox.checked;
            }
            
            // ä¿å­˜æœ€å°åŒ–è‡ªåŠ¨é”å®šè®¾ç½®
            if (enableMinimizeLockCheckbox) {
                settings.security.enableMinimizeLock = enableMinimizeLockCheckbox.checked;
            }
            
            if (minimizeLockDelaySelect) {
                settings.security.minimizeLockDelay = parseInt(minimizeLockDelaySelect.value);
            }
            
            // ä¿å­˜é€æ˜åº¦è®¾ç½®
            saveOpacitySettings(settings);
            
            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('appSettings', JSON.stringify(settings));
            
            // é‡æ–°åˆå§‹åŒ–è‡ªåŠ¨é”å®šè®¡æ—¶å™¨
            initAutoLockTimer();
            
            message.success('æ‰€æœ‰è®¾ç½®å·²ä¿å­˜');
        }
        
        // åˆå§‹åŒ–è®¾ç½®ç•Œé¢
        document.addEventListener('DOMContentLoaded', () => {
            // ç›‘å¬è‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡é€‰æ‹©
            const customBackgroundInput = document.getElementById('customBackground');
            const backgroundPreview = document.getElementById('backgroundPreview');
            
            // åˆå§‹åŒ–é€æ˜åº¦è®¾ç½®
            const opacitySlider = document.getElementById('opacitySlider');
            const opacityInput = document.getElementById('opacityInput');
            const opacityValue = document.getElementById('opacityValue');
            const opacityPreview = document.getElementById('opacityPreview');
            
            if (customBackgroundInput && backgroundPreview) {
                customBackgroundInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            backgroundPreview.style.backgroundImage = `url('${event.target.result}')`;
                            backgroundPreview.style.backgroundSize = 'cover';
                            backgroundPreview.style.backgroundPosition = 'center';
                            backgroundPreview.innerHTML = '';
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            
            // åˆå§‹åŒ–èƒŒæ™¯é¢„è§ˆå°ºå¯¸
            updateBackgroundPreviewSize();
            
            // åˆå§‹åŒ–é€æ˜åº¦è®¾ç½®
            if (opacitySlider && opacityInput && opacityValue && opacityPreview) {
                // ç›‘å¬æ»‘å—å˜åŒ–
                opacitySlider.addEventListener('input', (e) => {
                    const value = e.target.value;
                    opacityInput.value = value;
                    opacityValue.textContent = value + '%';
                    updateOpacityPreview(value);
                });
                
                // ç›‘å¬è¾“å…¥æ¡†å˜åŒ–
                opacityInput.addEventListener('input', (e) => {
                    let value = parseInt(e.target.value);
                    if (isNaN(value)) value = 100;
                    if (value < 0) value = 0;
                    if (value > 100) value = 100;
                    opacitySlider.value = value;
                    opacityValue.textContent = value + '%';
                    updateOpacityPreview(value);
                });
            }
            
            // æ·»åŠ çª—å£å¤§å°å˜åŒ–ç›‘å¬
            window.addEventListener('resize', updateBackgroundPreviewSize);
            
            // åŠ è½½æ‰€æœ‰å·²ä¿å­˜çš„è®¾ç½®
            loadSettings();
            
            // åˆå§‹åŒ–è‡ªåŠ¨é”å®šè®¡æ—¶å™¨
            initAutoLockTimer();
            
            // ç›‘å¬ç”¨æˆ·æ´»åŠ¨ï¼Œé‡ç½®è‡ªåŠ¨é”å®šè®¡æ—¶å™¨
            document.addEventListener('mousemove', resetAutoLockTimer);
            document.addEventListener('keypress', resetAutoLockTimer);
            document.addEventListener('click', resetAutoLockTimer);
            
            // ç›‘å¬çª—å£çŠ¶æ€å˜åŒ–ï¼ˆæœ€å°åŒ–/æ¢å¤ï¼‰
            setupWindowStateListeners();
        });
        
        // æ›´æ–°èƒŒæ™¯é¢„è§ˆå°ºå¯¸ï¼Œä½¿å…¶åŒ¹é…åº”ç”¨ç¨‹åºçš„å®é™…å®½é«˜æ¯”ä¾‹
        function updateBackgroundPreviewSize() {
            const backgroundPreview = document.getElementById('backgroundPreview');
            const appAspectRatio = document.getElementById('appAspectRatio');
            if (!backgroundPreview) return;
            
            try {
                // è·å–åº”ç”¨ç¨‹åºçš„å®é™…å®½é«˜
                const appWidth = window.innerWidth;
                const appHeight = window.innerHeight;
                
                // è®¡ç®—å®½é«˜æ¯”
                const aspectRatio = appWidth / appHeight;
                
                // æ ¼å¼åŒ–å®½é«˜æ¯”æ˜¾ç¤ºï¼ˆä¾‹å¦‚ï¼š16:9, 4:3, 1:1ï¼‰
                const formattedRatio = formatAspectRatio(appWidth, appHeight);
                
                // æ›´æ–°å®½é«˜æ¯”ä¾‹ä¿¡æ¯æ˜¾ç¤º
                if (appAspectRatio) {
                    appAspectRatio.textContent = `(åº”ç”¨å®½é«˜æ¯”: ${formattedRatio}, å®é™…å°ºå¯¸: ${appWidth}x${appHeight}px)`;
                }
                
                // è®¾ç½®é¢„è§ˆåŒºåŸŸçš„æœ€å¤§å®½åº¦å’Œé«˜åº¦
                const maxPreviewHeight = 300; // æœ€å¤§é¢„è§ˆé«˜åº¦ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
                const maxPreviewWidth = 500; // æœ€å¤§é¢„è§ˆå®½åº¦ï¼Œå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´
                
                // æ ¹æ®å®½é«˜æ¯”è®¡ç®—é¢„è§ˆåŒºåŸŸçš„å®é™…å°ºå¯¸
                let previewWidth, previewHeight;
                
                if (aspectRatio > 1) {
                    // æ¨ªå‘å±å¹•
                    previewWidth = Math.min(maxPreviewWidth, maxPreviewHeight * aspectRatio);
                    previewHeight = previewWidth / aspectRatio;
                } else {
                    // çºµå‘å±å¹•
                    previewHeight = Math.min(maxPreviewHeight, maxPreviewWidth / aspectRatio);
                    previewWidth = previewHeight * aspectRatio;
                }
                
                // æ›´æ–°é¢„è§ˆåŒºåŸŸçš„å°ºå¯¸
                backgroundPreview.style.width = `${previewWidth}px`;
                backgroundPreview.style.height = `${previewHeight}px`;
                backgroundPreview.style.maxWidth = '100%';
                backgroundPreview.style.objectFit = 'contain';
                
                console.log(`ğŸ” èƒŒæ™¯é¢„è§ˆå°ºå¯¸å·²æ›´æ–°ï¼š${previewWidth}x${previewHeight}pxï¼Œåº”ç”¨å°ºå¯¸ï¼š${appWidth}x${appHeight}pxï¼Œæ¯”ä¾‹ï¼š${aspectRatio.toFixed(2)}`);
            } catch (error) {
                console.error('ğŸ” æ›´æ–°èƒŒæ™¯é¢„è§ˆå°ºå¯¸å¤±è´¥ï¼š', error);
            }
        }
        
        // æ ¼å¼åŒ–å®½é«˜æ¯”ï¼Œè¿”å›ç®€åŒ–çš„æ¯”ä¾‹å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ï¼š16:9, 4:3, 1:1ï¼‰
        function formatAspectRatio(width, height) {
            // è®¡ç®—æœ€å¤§å…¬çº¦æ•°
            function gcd(a, b) {
                return b === 0 ? a : gcd(b, a % b);
            }
            
            const commonDivisor = gcd(width, height);
            const ratioWidth = width / commonDivisor;
            const ratioHeight = height / commonDivisor;
            
            return `${ratioWidth}:${ratioHeight}`;
        }
        
        // è®¾ç½®çª—å£çŠ¶æ€ç›‘å¬å™¨
        function setupWindowStateListeners() {
            try {
                // æ£€æŸ¥æ˜¯å¦åœ¨Electronç¯å¢ƒä¸­
                if (window.electron) {
                    // ä½¿ç”¨Electronçš„çª—å£äº‹ä»¶ç›‘å¬
                    window.electron.on('window-minimize', handleWindowMinimize);
                    window.electron.on('window-restore', handleWindowRestore);
                    console.log('ğŸ”’ å·²è®¾ç½®Electronçª—å£çŠ¶æ€ç›‘å¬å™¨');
                } else if (window.require) {
                    // ç›´æ¥ä½¿ç”¨Electronçš„remoteæ¨¡å—ï¼ˆæ—§ç‰ˆæœ¬Electronï¼‰
                    try {
                        const { remote } = window.require('electron');
                        const currentWindow = remote.getCurrentWindow();
                        
                        currentWindow.on('minimize', handleWindowMinimize);
                        currentWindow.on('restore', handleWindowRestore);
                        console.log('ğŸ”’ å·²è®¾ç½®Electron remoteçª—å£çŠ¶æ€ç›‘å¬å™¨');
                    } catch (error) {
                        console.warn('ğŸ”’ ä½¿ç”¨Electron remoteå¤±è´¥:', error.message);
                        // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨å®šæ—¶å™¨æ£€æŸ¥å¯è§æ€§å˜åŒ–
                        setupVisibilityChangeListener();
                    }
                } else {
                    // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨å®šæ—¶å™¨æ£€æŸ¥å¯è§æ€§å˜åŒ–
                    setupVisibilityChangeListener();
                }
            } catch (error) {
                console.error('ğŸ”’ è®¾ç½®çª—å£çŠ¶æ€ç›‘å¬å™¨å¤±è´¥:', error);
                // é™çº§æ–¹æ¡ˆï¼šä½¿ç”¨å®šæ—¶å™¨æ£€æŸ¥å¯è§æ€§å˜åŒ–
                setupVisibilityChangeListener();
            }
        }
        
        // è®¾ç½®å¯è§æ€§å˜åŒ–ç›‘å¬å™¨ï¼ˆé™çº§æ–¹æ¡ˆï¼‰
        function setupVisibilityChangeListener() {
            // ç›‘å¬æ–‡æ¡£å¯è§æ€§å˜åŒ–
            document.addEventListener('visibilitychange', () => {
                if (document.hidden) {
                    // æ–‡æ¡£ä¸å¯è§ï¼Œå¯èƒ½æ˜¯æœ€å°åŒ–æˆ–åˆ‡æ¢åˆ°å…¶ä»–çª—å£
                    handleWindowMinimize();
                } else {
                    // æ–‡æ¡£å¯è§ï¼Œæ¢å¤æ­£å¸¸
                    handleWindowRestore();
                }
            });
            console.log('ğŸ”’ å·²è®¾ç½®å¯è§æ€§å˜åŒ–ç›‘å¬å™¨');
        }
        
        // å¤„ç†çª—å£æœ€å°åŒ–äº‹ä»¶
        function handleWindowMinimize() {
            try {
                console.log('ğŸ”’ çª—å£å·²æœ€å°åŒ–');
                isMinimized = true;
                
                // è·å–æœ€å°åŒ–è‡ªåŠ¨é”å®šè®¾ç½®
                const settings = JSON.parse(localStorage.getItem('appSettings') || '{}');
                const enableMinimizeLock = settings.security?.enableMinimizeLock || false;
                
                if (enableMinimizeLock) {
                    const minimizeLockDelay = settings.security?.minimizeLockDelay || 0;
                    console.log(`ğŸ”’ æœ€å°åŒ–è‡ªåŠ¨é”å®šå·²å¯ç”¨ï¼Œå°†åœ¨ ${minimizeLockDelay / 1000} ç§’åé”å®š`);
                    
                    // æ¸…é™¤ç°æœ‰è®¡æ—¶å™¨
                    if (minimizeLockTimer) {
                        clearTimeout(minimizeLockTimer);
                    }
                    
                    // è®¾ç½®æ–°çš„è®¡æ—¶å™¨
                    minimizeLockTimer = setTimeout(() => {
                        try {
                            // æ£€æŸ¥æ˜¯å¦ä»å¤„äºæœ€å°åŒ–çŠ¶æ€
                            if (isMinimized) {
                                console.log('ğŸ”’ æœ€å°åŒ–é”å®šæ—¶é—´å·²åˆ°ï¼Œæ‰§è¡Œé”å®š');
                                lockApplication();
                            }
                        } catch (error) {
                            console.error('ğŸ”’ æœ€å°åŒ–é”å®šæ‰§è¡Œå¤±è´¥:', error);
                        }
                    }, minimizeLockDelay);
                } else {
                    console.log('ğŸ”’ æœ€å°åŒ–è‡ªåŠ¨é”å®šå·²ç¦ç”¨');
                }
            } catch (error) {
                console.error('ğŸ”’ å¤„ç†çª—å£æœ€å°åŒ–äº‹ä»¶å¤±è´¥:', error);
            }
        }
        
        // å¤„ç†çª—å£æ¢å¤äº‹ä»¶
        function handleWindowRestore() {
            try {
                console.log('ğŸ”’ çª—å£å·²æ¢å¤');
                isMinimized = false;
                
                // æ¸…é™¤æœ€å°åŒ–é”å®šè®¡æ—¶å™¨
                if (minimizeLockTimer) {
                    clearTimeout(minimizeLockTimer);
                    minimizeLockTimer = null;
                    console.log('ğŸ”’ æœ€å°åŒ–é”å®šè®¡æ—¶å™¨å·²æ¸…é™¤');
                }
            } catch (error) {
                console.error('ğŸ”’ å¤„ç†çª—å£æ¢å¤äº‹ä»¶å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½æ‰€æœ‰è®¾ç½®
        function loadSettings() {
            // åŠ è½½èƒŒæ™¯è®¾ç½®
            loadCustomBackground();
            
            // åŠ è½½å®‰å…¨è®¾ç½®
            loadSecuritySettings();
            
            // åŠ è½½å½“å‰å®‰å…¨é—®é¢˜
            loadCurrentSecurityQuestion();
            
            // åŠ è½½é€æ˜åº¦è®¾ç½®
            loadOpacitySettings();
        }
        
        // åŠ è½½å®‰å…¨è®¾ç½®
        function loadSecuritySettings() {
            const settings = JSON.parse(localStorage.getItem('appSettings') || '{}');
            const securitySettings = settings.security || {
                autoLockTime: '1åˆ†é’Ÿ',
                enableAutoBackup: false,
                enableMinimizeLock: false,
                minimizeLockDelay: 0 // é»˜è®¤ç«‹å³é”å®š
            };
            
            // æ›´æ–°ç•Œé¢
            const autoLockTimeSelect = document.querySelector('#securitySetting select');
            const enableAutoBackupCheckbox = document.querySelector('#securitySetting input[type="checkbox"]');
            const enableMinimizeLockCheckbox = document.getElementById('enableMinimizeLock');
            const minimizeLockDelaySelect = document.getElementById('minimizeLockDelay');
            
            if (autoLockTimeSelect) {
                autoLockTimeSelect.value = securitySettings.autoLockTime;
            }
            
            if (enableAutoBackupCheckbox) {
                enableAutoBackupCheckbox.checked = securitySettings.enableAutoBackup;
            }
            
            if (enableMinimizeLockCheckbox) {
                enableMinimizeLockCheckbox.checked = securitySettings.enableMinimizeLock;
            }
            
            if (minimizeLockDelaySelect) {
                minimizeLockDelaySelect.value = securitySettings.minimizeLockDelay;
            }
            
            console.log('ğŸ”’ å·²åŠ è½½å®‰å…¨è®¾ç½®:', securitySettings);
        }
        
        // è‡ªåŠ¨é”å®šè®¡æ—¶å™¨ç›¸å…³å˜é‡
        let autoLockTimer = null;
        let lastActivityTime = Date.now();
        
        // æœ€å°åŒ–é”å®šç›¸å…³å˜é‡
        let minimizeLockTimer = null;
        let isMinimized = false;
        
        // åˆå§‹åŒ–è‡ªåŠ¨é”å®šè®¡æ—¶å™¨
        function initAutoLockTimer() {
            // æ¸…é™¤ç°æœ‰è®¡æ—¶å™¨
            if (autoLockTimer) {
                clearTimeout(autoLockTimer);
            }
            
            // è·å–è‡ªåŠ¨é”å®šæ—¶é—´è®¾ç½®
            const settings = JSON.parse(localStorage.getItem('appSettings') || '{}');
            const autoLockTime = settings.security?.autoLockTime || '1åˆ†é’Ÿ';
            
            // è½¬æ¢ä¸ºæ¯«ç§’
            const lockTimeMs = getLockTimeInMs(autoLockTime);
            
            // å¦‚æœè®¾ç½®ä¸º"ä»ä¸"ï¼Œåˆ™ä¸å¯åŠ¨è®¡æ—¶å™¨
            if (lockTimeMs === 0) {
                console.log('ğŸ”’ è‡ªåŠ¨é”å®šå·²ç¦ç”¨');
                return;
            }
            
            // å¯åŠ¨è®¡æ—¶å™¨
            autoLockTimer = setTimeout(() => {
                // æ£€æŸ¥æ˜¯å¦éœ€è¦é”å®šï¼ˆå¦‚æœç”¨æˆ·åœ¨è®¡æ—¶æœŸé—´æœ‰æ´»åŠ¨ï¼Œåˆ™é‡ç½®è®¡æ—¶å™¨ï¼‰
                const currentTime = Date.now();
                if (currentTime - lastActivityTime >= lockTimeMs) {
                    console.log('ğŸ”’ è‡ªåŠ¨é”å®šè§¦å‘');
                    lockApplication();
                } else {
                    // ç”¨æˆ·æœ‰æ´»åŠ¨ï¼Œé‡æ–°å¯åŠ¨è®¡æ—¶å™¨
                    initAutoLockTimer();
                }
            }, lockTimeMs);
            
            console.log(`ğŸ”’ è‡ªåŠ¨é”å®šè®¡æ—¶å™¨å·²å¯åŠ¨ï¼Œå°†åœ¨ ${autoLockTime} åé”å®š`);
        }
        
        // é‡ç½®è‡ªåŠ¨é”å®šè®¡æ—¶å™¨
        function resetAutoLockTimer() {
            lastActivityTime = Date.now();
            initAutoLockTimer();
        }
        
        // å°†è‡ªåŠ¨é”å®šæ—¶é—´è½¬æ¢ä¸ºæ¯«ç§’
        function getLockTimeInMs(lockTime) {
            switch (lockTime) {
                case '1åˆ†é’Ÿ':
                    return 1 * 60 * 1000;
                case '5åˆ†é’Ÿ':
                    return 5 * 60 * 1000;
                case '10åˆ†é’Ÿ':
                    return 10 * 60 * 1000;
                case '30åˆ†é’Ÿ':
                    return 30 * 60 * 1000;
                case '1å°æ—¶':
                    return 60 * 60 * 1000;
                case 'ä»ä¸':
                    return 0;
                default:
                    return 5 * 60 * 1000; // é»˜è®¤5åˆ†é’Ÿ
            }
        }
        
        // åŠ è½½è‡ªå®šä¹‰èƒŒæ™¯
        function loadCustomBackground() {
            let backgroundSettings = null;
            
            // å…ˆå°è¯•ä»æ–°çš„appSettingsä¸­åŠ è½½
            const appSettings = JSON.parse(localStorage.getItem('appSettings') || '{}');
            if (appSettings.appearance && appSettings.appearance.customBackground) {
                backgroundSettings = appSettings.appearance.customBackground;
            } else {
                // å‘åå…¼å®¹ï¼šå°è¯•ä»æ—§çš„customBackgroundä¸­åŠ è½½
                backgroundSettings = JSON.parse(localStorage.getItem('customBackground'));
            }
            
            if (backgroundSettings && backgroundSettings.applied) {
                // åº”ç”¨èƒŒæ™¯åˆ°é¡µé¢
                document.body.style.backgroundImage = `url(${backgroundSettings.url})`;
                document.body.style.backgroundSize = backgroundSettings.size;
                document.body.style.backgroundPosition = 'center';
                document.body.style.backgroundRepeat = 'no-repeat';
                document.body.style.backgroundAttachment = 'fixed';
                
                // æ›´æ–°é¢„è§ˆ
                const backgroundPreview = document.getElementById('backgroundPreview');
                if (backgroundPreview) {
                    backgroundPreview.style.backgroundImage = `url(${backgroundSettings.url})`;
                    backgroundPreview.style.backgroundSize = backgroundSettings.size;
                    backgroundPreview.style.backgroundPosition = 'center';
                    backgroundPreview.innerHTML = '';
                }
            }
        }
        
        // é‡ç½®ä¸ºé»˜è®¤èƒŒæ™¯
        function resetBackground() {
            // æ¸…é™¤é¡µé¢èƒŒæ™¯
            document.body.style.backgroundImage = '';
            document.body.style.backgroundSize = '';
            document.body.style.backgroundPosition = '';
            document.body.style.backgroundRepeat = '';
            document.body.style.backgroundAttachment = '';
            
            // æ¸…é™¤localStorageä¸­çš„èƒŒæ™¯è®¾ç½®
            localStorage.removeItem('customBackground');
            
            // åŒæ—¶æ›´æ–°appSettings
            const appSettings = JSON.parse(localStorage.getItem('appSettings') || '{}');
            if (appSettings.appearance) {
                appSettings.appearance.customBackground = null;
                localStorage.setItem('appSettings', JSON.stringify(appSettings));
            }
            
            // æ›´æ–°é¢„è§ˆ
            const backgroundPreview = document.getElementById('backgroundPreview');
            if (backgroundPreview) {
                backgroundPreview.style.backgroundImage = '';
                backgroundPreview.innerHTML = '<span style="color: var(--ios-text-tertiary);">å½“å‰æ— è‡ªå®šä¹‰èƒŒæ™¯</span>';
            }
            
            message.success('å·²æ¢å¤é»˜è®¤èƒŒæ™¯');
        }
        
        // ä¿å­˜å®‰å…¨é—®é¢˜
        async function saveSecurityQuestion() {
            const questionSelect = document.getElementById('securityQuestionSelect');
            const answerInput = document.getElementById('securityQuestionAnswer');
            
            if (!questionSelect.value || !answerInput.value.trim()) {
                message.error('è¯·é€‰æ‹©å®‰å…¨é—®é¢˜å¹¶è¾“å…¥ç­”æ¡ˆ');
                return;
            }
            
            try {
                const result = await window.passwordManager.setupSecurityQuestion({
                    question: questionSelect.value,
                    answer: answerInput.value.trim()
                });
                
                if (result.success) {
                    message.success('å®‰å…¨é—®é¢˜å·²ä¿å­˜');
                    answerInput.value = '';
                    
                    // æ›´æ–°å½“å‰å®‰å…¨é—®é¢˜æ˜¾ç¤º
                    loadCurrentSecurityQuestion();
                } else {
                    message.error('ä¿å­˜å¤±è´¥ï¼š' + result.message);
                }
            } catch (error) {
                console.error('Save security question error:', error);
                message.error('æ“ä½œå¤±è´¥ï¼š' + error.message);
            }
        }
        
        // æ˜¾ç¤ºå®‰å…¨é—®é¢˜éªŒè¯ç•Œé¢
        function showSecurityQuestionVerification(question) {
            const verificationScreen = document.getElementById('securityQuestionVerificationScreen');
            const questionText = document.getElementById('verificationQuestion');
            
            // è®¾ç½®å®‰å…¨é—®é¢˜æ–‡æœ¬
            questionText.textContent = question;
            
            // éšè—å…¶ä»–ç•Œé¢
            authScreen.style.display = 'none';
            passwordManagerScreen.style.display = 'none';
            settingsScreen.style.display = 'none';
            
            // æ˜¾ç¤ºéªŒè¯ç•Œé¢
            verificationScreen.style.display = 'block';
            
            // æ¸…ç©ºè¾“å…¥å’Œé”™è¯¯ä¿¡æ¯
            document.getElementById('verificationAnswer').value = '';
            const verificationError = document.getElementById('verificationError');
            verificationError.style.display = 'none';
        }
        
        // éªŒè¯å®‰å…¨é—®é¢˜ç­”æ¡ˆ
        async function verifySecurityQuestionAnswer() {
            const answerInput = document.getElementById('verificationAnswer');
            const verificationError = document.getElementById('verificationError');
            
            if (!answerInput.value.trim()) {
                message.error('è¯·è¾“å…¥ç­”æ¡ˆ');
                return;
            }
            
            try {
                const result = await window.passwordManager.verifySecurityQuestion({
                    answer: answerInput.value.trim()
                });
                
                if (result.success) {
                    // éªŒè¯æˆåŠŸï¼Œæ˜¾ç¤ºä¿®æ”¹ä¸»å¯†ç ç•Œé¢
                    showResetMasterPasswordScreen();
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯æç¤º
                    verificationError.querySelector('p').textContent = 'å®‰å…¨é—®é¢˜ç­”æ¡ˆä¸æ­£ç¡®ï¼Œè¯·é‡è¯•';
                    verificationError.style.display = 'block';
                }
            } catch (error) {
                console.error('Verify security question error:', error);
                message.error('éªŒè¯å¤±è´¥ï¼š' + error.message);
            }
        }
        
        // æ˜¾ç¤ºä¿®æ”¹ä¸»å¯†ç ç•Œé¢
        function showResetMasterPasswordScreen() {
            const verificationScreen = document.getElementById('securityQuestionVerificationScreen');
            const resetScreen = document.getElementById('resetMasterPasswordScreen');
            
            // éšè—éªŒè¯ç•Œé¢
            verificationScreen.style.display = 'none';
            
            // æ˜¾ç¤ºä¿®æ”¹ä¸»å¯†ç ç•Œé¢
            resetScreen.style.display = 'block';
            
            // æ¸…ç©ºè¾“å…¥å’Œé”™è¯¯ä¿¡æ¯
            const newPasswordInput = document.getElementById('newMasterPassword');
            const confirmPasswordInput = document.getElementById('confirmNewMasterPassword');
            const resetPasswordError = document.getElementById('resetPasswordError');
            
            if (newPasswordInput) {
                newPasswordInput.value = '';
            }
            
            if (confirmPasswordInput) {
                confirmPasswordInput.value = '';
            }
            
            if (resetPasswordError) {
                resetPasswordError.style.display = 'none';
            }
        }
        
        // é‡ç½®ä¸»å¯†ç 
        async function resetMasterPassword() {
            const newPassword = document.getElementById('newMasterPassword').value;
            const confirmPassword = document.getElementById('confirmNewMasterPassword').value;
            const resetPasswordError = document.getElementById('resetPasswordError');
            
            // éªŒè¯è¾“å…¥
            if (!newPassword || !confirmPassword) {
                resetPasswordError.querySelector('p').textContent = 'è¯·å¡«å†™æ‰€æœ‰å­—æ®µ';
                resetPasswordError.style.display = 'block';
                return;
            }
            
            if (newPassword.length < 8) {
                resetPasswordError.querySelector('p').textContent = 'æ–°å¯†ç é•¿åº¦è‡³å°‘ä¸º8ä¸ªå­—ç¬¦';
                resetPasswordError.style.display = 'block';
                return;
            }
            
            if (newPassword !== confirmPassword) {
                resetPasswordError.querySelector('p').textContent = 'ä¸¤æ¬¡è¾“å…¥çš„æ–°å¯†ç ä¸ä¸€è‡´';
                resetPasswordError.style.display = 'block';
                return;
            }
            
            try {
                const result = await window.passwordManager.resetMasterPasswordBySecurityQuestion({
                    newPassword: newPassword
                });
                
                if (result.success) {
                    message.success('ä¸»å¯†ç ä¿®æ”¹æˆåŠŸï¼Œè¯·é‡æ–°ç™»å½•');
                    
                    // æ¸…ç©ºè¡¨å•
                    document.getElementById('newMasterPassword').value = '';
                    document.getElementById('confirmNewMasterPassword').value = '';
                    
                    // è¿”å›ç™»å½•ç•Œé¢
                    showLoginScreen();
                } else {
                    resetPasswordError.querySelector('p').textContent = result.message;
                    resetPasswordError.style.display = 'block';
                }
            } catch (error) {
                console.error('Reset master password error:', error);
                message.error('æ“ä½œå¤±è´¥ï¼š' + error.message);
            }
        }
        
        // åŠ è½½å½“å‰å®‰å…¨é—®é¢˜
        async function loadCurrentSecurityQuestion() {
            try {
                // ç¡®ä¿åªåœ¨å®‰å…¨è®¾ç½®ç•Œé¢åŠ è½½æ—¶æ‰§è¡Œ
                const securitySetting = document.getElementById('securitySetting');
                if (!securitySetting || securitySetting.style.display === 'none') {
                    console.log('ğŸ” å®‰å…¨è®¾ç½®ç•Œé¢æœªæ˜¾ç¤ºï¼Œè·³è¿‡åŠ è½½å®‰å…¨é—®é¢˜');
                    return;
                }
                
                console.log('ğŸ” å¼€å§‹åŠ è½½å®‰å…¨é—®é¢˜ä¿¡æ¯...');
                const securityQuestionInfo = await window.passwordManager.getSecurityQuestion();
                console.log('ğŸ” è·å–åˆ°å®‰å…¨é—®é¢˜ä¿¡æ¯:', securityQuestionInfo);
                
                const currentSecurityQuestion = document.getElementById('currentSecurityQuestion');
                const currentQuestionText = document.getElementById('currentQuestionText');
                
                if (securityQuestionInfo.hasQuestion) {
                    console.log('ğŸ” æ˜¾ç¤ºå·²è®¾ç½®çš„å®‰å…¨é—®é¢˜:', securityQuestionInfo.question);
                    currentSecurityQuestion.style.display = 'block';
                    currentQuestionText.textContent = securityQuestionInfo.question;
                } else {
                    console.log('ğŸ” æœªè®¾ç½®å®‰å…¨é—®é¢˜');
                    currentSecurityQuestion.style.display = 'none';
                }
            } catch (error) {
                console.error('Load security question error:', error);
            }
        }
        
        // åŠ è½½é€æ˜åº¦è®¾ç½®
        function loadOpacitySettings() {
            const settings = JSON.parse(localStorage.getItem('appSettings') || '{}');
            const opacitySettings = settings.appearance?.opacity || 100;
            
            const opacitySlider = document.getElementById('opacitySlider');
            const opacityInput = document.getElementById('opacityInput');
            const opacityValue = document.getElementById('opacityValue');
            
            if (opacitySlider) {
                opacitySlider.value = opacitySettings;
            }
            
            if (opacityInput) {
                opacityInput.value = opacitySettings;
            }
            
            if (opacityValue) {
                opacityValue.textContent = opacitySettings + '%';
            }
            
            // åº”ç”¨é€æ˜åº¦åˆ°ç•Œé¢
            applyOpacityToAllInterfaces(opacitySettings);
            
            console.log('ğŸ” å·²åŠ è½½é€æ˜åº¦è®¾ç½®:', opacitySettings + '%');
        }
        
        // æ›´æ–°é€æ˜åº¦é¢„è§ˆ
        function updateOpacityPreview(value) {
            const opacityPreview = document.getElementById('opacityPreview');
            if (!opacityPreview) return;
            
            const opacity = value / 100;
            opacityPreview.style.opacity = opacity;
        }
        
        // åº”ç”¨é€æ˜åº¦åˆ°æ‰€æœ‰ç•Œé¢
        function applyOpacityToAllInterfaces(opacityPercent) {
            const opacity = opacityPercent / 100;
            
            // åº”ç”¨åˆ°ç™»å½•ç•Œé¢
            const authScreen = document.getElementById('authScreen');
            if (authScreen) {
                authScreen.style.opacity = opacity;
            }
            
            // åº”ç”¨åˆ°è®¾ç½®ç•Œé¢
            const setupScreen = document.getElementById('setupScreen');
            if (setupScreen) {
                setupScreen.style.opacity = opacity;
            }
            
            // åº”ç”¨åˆ°å¯†ç ç®¡ç†ç•Œé¢
            const passwordManagerScreen = document.getElementById('passwordManagerScreen');
            if (passwordManagerScreen) {
                passwordManagerScreen.style.opacity = opacity;
            }
            
            // åº”ç”¨åˆ°å®‰å…¨é—®é¢˜éªŒè¯ç•Œé¢
            const securityQuestionVerificationScreen = document.getElementById('securityQuestionVerificationScreen');
            if (securityQuestionVerificationScreen) {
                securityQuestionVerificationScreen.style.opacity = opacity;
            }
            
            // åº”ç”¨åˆ°ä¿®æ”¹ä¸»å¯†ç ç•Œé¢
            const resetMasterPasswordScreen = document.getElementById('resetMasterPasswordScreen');
            if (resetMasterPasswordScreen) {
                resetMasterPasswordScreen.style.opacity = opacity;
            }
            
            console.log('ğŸ” å·²åº”ç”¨é€æ˜åº¦åˆ°æ‰€æœ‰ç•Œé¢:', opacityPercent + '%');
        }
        
        // ä¿å­˜é€æ˜åº¦è®¾ç½®
        function saveOpacitySettings(settings) {
            const opacitySlider = document.getElementById('opacitySlider');
            const opacityInput = document.getElementById('opacityInput');
            
            let opacityValue = 100;
            
            if (opacitySlider) {
                opacityValue = parseInt(opacitySlider.value);
            }
            
            if (opacityInput) {
                opacityValue = parseInt(opacityInput.value);
            }
            
            // éªŒè¯é€æ˜åº¦å€¼
            if (isNaN(opacityValue)) opacityValue = 100;
            if (opacityValue < 0) opacityValue = 0;
            if (opacityValue > 100) opacityValue = 100;
            
            // ä¿å­˜åˆ°è®¾ç½®
            if (!settings.appearance) {
                settings.appearance = {};
            }
            settings.appearance.opacity = opacityValue;
            
            // åº”ç”¨é€æ˜åº¦åˆ°ç•Œé¢
            applyOpacityToAllInterfaces(opacityValue);
            
            console.log('ğŸ” å·²ä¿å­˜é€æ˜åº¦è®¾ç½®:', opacityValue + '%');
        }

        // å¤„ç†ç™»å½•
        async function handleLogin() {
            const password = document.getElementById('loginPassword').value;
            
            // éªŒè¯è¾“å…¥
            if (!password || password.trim() === '') {
                loginError.textContent = 'è¯·è¾“å…¥ä¸»å¯†ç ';
                return;
            }
            
            try {
                    const result = await window.passwordManager.loginMasterPassword(password);
                    if (result.success) {
                        // ç™»å½•æˆåŠŸï¼Œåˆ‡æ¢åˆ°å¯†ç ç®¡ç†ç•Œé¢
                        authScreen.style.display = 'none';
                        passwordManagerScreen.style.display = 'block';
                        // é»˜è®¤æ˜¾ç¤ºå·²ä¿å­˜å¯†ç ç•Œé¢
                        await showSavedPasswordsScreen();
                    } else {
                        loginError.textContent = result.message;
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    loginError.textContent = 'ç™»å½•å¤±è´¥ï¼š' + error.message;
                }
        }

        // å¤„ç†å¿˜è®°ä¸»å¯†ç 
        async function handleForgotPassword() {
            try {
                // æ£€æŸ¥æ˜¯å¦å·²è®¾ç½®å®‰å…¨é—®é¢˜
                const securityQuestionInfo = await window.passwordManager.getSecurityQuestion();
                
                if (securityQuestionInfo.hasQuestion) {
                    // å·²è®¾ç½®å®‰å…¨é—®é¢˜ï¼Œæ˜¾ç¤ºé€‰é¡¹
                    showForgotPasswordOptions(securityQuestionInfo.question);
                } else {
                    // æœªè®¾ç½®å®‰å…¨é—®é¢˜ï¼Œæ˜¾ç¤ºæ¸…é™¤æ•°æ®ç¡®è®¤
                    showForgotPasswordClearData();
                }
            } catch (error) {
                console.error('Forgot password error:', error);
                message.error('æ“ä½œå¤±è´¥ï¼š' + error.message);
            }
        }
        
        // æ˜¾ç¤ºå¿˜è®°ä¸»å¯†ç é€‰é¡¹ï¼ˆå·²è®¾ç½®å®‰å…¨é—®é¢˜ï¼‰
        function showForgotPasswordOptions(question) {
            const modal = document.createElement('div');
            modal.className = 'secondary-auth-modal';
            modal.innerHTML = `
                <div class="secondary-auth-modal-content">
                    <h3>å¿˜è®°ä¸»å¯†ç </h3>
                    <p style="color: var(--ios-text-secondary); margin-bottom: 20px;">
                        æ‚¨å·²è®¾ç½®å®‰å…¨é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡éªŒè¯å®‰å…¨é—®é¢˜æ‰¾å›ä¸»å¯†ç ï¼Œæˆ–è€…æ¸…é™¤æ‰€æœ‰æ•°æ®é‡æ–°è®¾ç½®ã€‚
                    </p>
                    <div style="background-color: #D1ECF1; border: 1px solid #B8DAFF; border-radius: var(--ios-corner-medium); padding: 16px; margin-bottom: 20px;">
                        <p style="color: #0C5460; margin-bottom: 8px;"><strong>â„¹ï¸ å®‰å…¨é—®é¢˜</strong></p>
                        <p style="color: #0C5460; margin: 0;">${question}</p>
                    </div>
                    <div class="secondary-auth-modal-buttons">
                        <button class="btn btn-cancel" style="flex: 1;">è¿”å›ç™»å½•</button>
                        <button class="btn btn-primary" style="flex: 1;">éªŒè¯å®‰å…¨é—®é¢˜</button>
                        <button class="btn btn-danger" style="flex: 1;">æ¸…é™¤æ•°æ®</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // ç»‘å®šè¿”å›ç™»å½•æŒ‰é’®äº‹ä»¶
            modal.querySelector('.btn-cancel').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            // ç»‘å®šéªŒè¯å®‰å…¨é—®é¢˜æŒ‰é’®äº‹ä»¶
            modal.querySelector('.btn-primary').addEventListener('click', () => {
                document.body.removeChild(modal);
                showSecurityQuestionVerification(question);
            });
            
            // ç»‘å®šæ¸…é™¤æ•°æ®æŒ‰é’®äº‹ä»¶
            modal.querySelector('.btn-danger').addEventListener('click', () => {
                document.body.removeChild(modal);
                showForgotPasswordClearData();
            });
        }
        
        // æ˜¾ç¤ºæ¸…é™¤æ•°æ®ç¡®è®¤ï¼ˆæœªè®¾ç½®å®‰å…¨é—®é¢˜ï¼‰
        function showForgotPasswordClearData() {
            const modal = document.createElement('div');
            modal.className = 'secondary-auth-modal';
            modal.innerHTML = `
                <div class="secondary-auth-modal-content">
                    <h3>å¿˜è®°ä¸»å¯†ç </h3>
                    <p style="color: var(--ios-text-secondary); margin-bottom: 20px;">
                        è¯·ä»”ç»†é˜…è¯»ä»¥ä¸‹å†…å®¹ï¼š
                    </p>
                    <div style="background-color: #FFF3CD; border: 1px solid #FFEEBA; border-radius: var(--ios-corner-medium); padding: 16px; margin-bottom: 20px;">
                        <p style="color: #856404; margin-bottom: 12px;"><strong>âš ï¸ é‡è¦åæœ</strong></p>
                        <ul style="color: #856404; margin: 0; padding-left: 20px; line-height: 1.6;">
                            <li>ç”±äºåŠ å¯†åŸç†é™åˆ¶ï¼Œ<strong>å¿˜è®°ä¸»å¯†ç åæ— æ³•æ¢å¤å·²ä¿å­˜çš„å¯†ç </strong></li>
                            <li>ç‚¹å‡»"ç¡®è®¤æ¸…é™¤"åï¼Œ<strong>æ‰€æœ‰æœ¬åœ°æ•°æ®å°†è¢«æ°¸ä¹…æ¸…é™¤</strong></li>
                            <li>æ¸…é™¤åæ‚¨éœ€è¦é‡æ–°è®¾ç½®ä¸»å¯†ç </li>
                            <li>æ­¤æ“ä½œ<strong>ä¸å¯æ’¤é”€</strong></li>
                        </ul>
                    </div>
                    <div class="secondary-auth-modal-buttons">
                        <button class="btn btn-cancel" style="flex: 1;">è¿”å›ç™»å½•</button>
                        <button class="btn btn-danger" style="flex: 1;">ç¡®è®¤æ¸…é™¤</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // ç»‘å®šè¿”å›ç™»å½•æŒ‰é’®äº‹ä»¶
            modal.querySelector('.btn-cancel').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            // ç»‘å®šç¡®è®¤æŒ‰é’®äº‹ä»¶
            modal.querySelector('.btn-danger').addEventListener('click', async () => {
                try {
                    // æ˜¾ç¤ºæ­£åœ¨å¤„ç†çš„æç¤º
                    message.info('æ­£åœ¨æ¸…é™¤æ•°æ®...');
                    
                    const result = await window.passwordManager.forgotMasterPassword();
                    if (result.success) {
                        message.success('æ•°æ®å·²æ¸…é™¤ï¼Œæ‚¨å¯ä»¥é‡æ–°è®¾ç½®ä¸»å¯†ç ');
                        document.body.removeChild(modal);
                        // é‡æ–°æ˜¾ç¤ºä¸»å¯†ç è®¾ç½®ç•Œé¢
                        authScreen.style.display = 'none';
                        setupScreen.style.display = 'block';
                    } else {
                        message.error('æ“ä½œå¤±è´¥ï¼š' + result.message);
                    }
                } catch (error) {
                    console.error('Forgot password error:', error);
                    message.error('æ“ä½œå¤±è´¥ï¼š' + error.message);
                }
            });
        }

        // å¤„ç†ä¸»å¯†ç è®¾ç½®æˆåŠŸåçš„é€»è¾‘
        async function handleSetupSuccess() {
            setupScreen.style.display = 'none';
            passwordManagerScreen.style.display = 'block';
            // é»˜è®¤æ˜¾ç¤ºæ·»åŠ å¯†ç ç•Œé¢
            showAddPasswordScreen();
        }

        // åŠ è½½å·²ä¿å­˜çš„å¯†ç 
        async function loadPasswords() {
            const passwords = await window.passwordManager.getPasswords();
            renderPasswords(passwords);
        }

        // æ¸²æŸ“å¯†ç åˆ—è¡¨
        function renderPasswords(passwords) {
            if (passwords.length === 0) {
                passwordsList.innerHTML = '<div class="empty-state">æš‚æ— ä¿å­˜çš„å¯†ç </div>';
                return;
            }

            passwordsList.innerHTML = passwords.map(password => `
                <div class="password-item" data-id="${password.id}">
                    <div class="password-info">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <h3>${password.service}</h3>
                            ${password.enableSecondaryAuth ? '<span class="secondary-auth-badge" title="å·²å¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯">ğŸ”’</span>' : ''}
                        </div>
                        <p>ç”¨æˆ·å: ${password.username}</p>
                        <div class="password-row">
                            <span>å¯†ç : </span>
                            <span class="password-text" id="password-text-${password.id}">${'*'.repeat(password.password.length)}</span>
                            <button 
                                class="btn btn-secondary btn-sm password-toggle" 
                                onclick="togglePasswordVisibility('${password.id}', '${password.password}', ${password.enableSecondaryAuth})"
                                aria-label="åˆ‡æ¢å¯†ç å¯è§æ€§"
                                aria-pressed="false"
                                data-password="${password.password}"
                                data-has-secondary-auth="${password.enableSecondaryAuth}"
                            >
                                <span class="btn-icon">ğŸ‘ï¸</span>
                            </button>
                        </div>
                    </div>
                    <div class="password-actions">
                        <button class="btn btn-success btn-sm" onclick="copyPassword('${password.id}', '${password.password}', ${password.enableSecondaryAuth})">
                            <span class="btn-icon">ğŸ“‹</span> å¤åˆ¶
                        </button>
                        <button class="btn btn-secondary btn-sm" onclick="toggleSecondaryAuth('${password.id}', ${password.enableSecondaryAuth})">
                            <span class="btn-icon">${password.enableSecondaryAuth ? 'ğŸ”“' : 'ğŸ”’'}</span> ${password.enableSecondaryAuth ? 'å…³é—­' : 'å¼€å¯'}äºŒæ¬¡éªŒè¯
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="deletePassword('${password.id}')">
                            <span class="btn-icon">ğŸ—‘ï¸</span> åˆ é™¤
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // å¤åˆ¶å¯†ç åˆ°å‰ªè´´æ¿
        window.copyPassword = async (id, password, hasSecondaryAuth) => {
            if (hasSecondaryAuth) {
                // å·²å¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯ï¼Œæ˜¾ç¤ºéªŒè¯å¼¹çª—
                const modal = document.createElement('div');
                modal.className = 'secondary-auth-modal';
                modal.innerHTML = `
                    <div class="secondary-auth-modal-content">
                        <h3>å¤åˆ¶å¯†ç </h3>
                        <div class="form-group">
                            <label for="verify-copy-secondary-password-${id}">è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç è¿›è¡ŒéªŒè¯</label>
                            <input type="password" id="verify-copy-secondary-password-${id}" placeholder="è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç " required>
                        </div>
                        <div class="error-message" id="verify-copy-secondary-error-${id}" style="margin-top: -16px; margin-bottom: 16px;"></div>
                        <div class="secondary-auth-modal-buttons">
                            <button class="btn btn-secondary" onclick="closeSecondaryAuthModal('${id}')">å–æ¶ˆ</button>
                            <button class="btn btn-primary" onclick="verifyAndCopyPassword('${id}', '${password}')">ç¡®å®š</button>
                        </div>
                    </div>
                `;
                
                // æ·»åŠ åˆ°æ–‡æ¡£
                document.body.appendChild(modal);
            } else {
                // æœªå¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯ï¼Œç›´æ¥å¤åˆ¶
                await navigator.clipboard.writeText(password);
                message.success('å¯†ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }
        };
        
        // éªŒè¯å¹¶å¤åˆ¶å¯†ç 
        window.verifyAndCopyPassword = async (id, password) => {
            const passwordInput = document.getElementById(`verify-copy-secondary-password-${id}`);
            const errorEl = document.getElementById(`verify-copy-secondary-error-${id}`);
            const secondaryPassword = passwordInput.value;
            
            if (!secondaryPassword) {
                errorEl.textContent = 'è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç ';
                return;
            }
            
            try {
                // å…ˆéªŒè¯äºŒæ¬¡å®‰å…¨å¯†ç 
                const verifyResult = await window.passwordManager.verifySecondaryPassword({
                    id: id,
                    secondaryPassword: secondaryPassword
                });
                
                if (verifyResult.success) {
                    // éªŒè¯æˆåŠŸï¼Œæ‰§è¡Œå¤åˆ¶æ“ä½œ
                    await navigator.clipboard.writeText(password);
                    
                    // å…³é—­å¼¹çª—
                    closeSecondaryAuthModal(id);
                    
                    // æ˜¾ç¤ºæˆåŠŸæç¤º
                    message.success('å¯†ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    errorEl.textContent = 'äºŒæ¬¡å®‰å…¨éªŒè¯å¯†ç è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°å°è¯•';
                }
            } catch (error) {
                console.error('å¤åˆ¶å¯†ç å¤±è´¥:', error);
                errorEl.textContent = 'å¤åˆ¶å¯†ç å¤±è´¥ï¼Œè¯·é‡è¯•';
            }
        };

        // iOS é£æ ¼åˆ é™¤å¯†ç ç¡®è®¤
        window.deletePassword = async (id) => {
            // æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
            if (window.confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¯†ç å—ï¼Ÿ')) {
                try {
                    // è·å–å½“å‰å¯†ç åˆ—è¡¨ï¼Œæ£€æŸ¥è¦åˆ é™¤çš„å¯†ç é¡¹æ˜¯å¦å¼€å¯äº†äºŒæ¬¡å®‰å…¨éªŒè¯
                    const passwords = await window.passwordManager.getPasswords();
                    const passwordItem = passwords.find(item => item.id === id);
                    
                    if (passwordItem && passwordItem.enableSecondaryAuth) {
                        // å·²å¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯ï¼Œæ˜¾ç¤ºéªŒè¯å¼¹çª—
                        const modal = document.createElement('div');
                        modal.className = 'secondary-auth-modal';
                        modal.innerHTML = `
                            <div class="secondary-auth-modal-content">
                                <h3>åˆ é™¤å¯†ç </h3>
                                <div class="form-group">
                                    <label for="verify-delete-secondary-password-${id}">è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç è¿›è¡ŒéªŒè¯</label>
                                    <input type="password" id="verify-delete-secondary-password-${id}" placeholder="è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç " required>
                                </div>
                                <div class="error-message" id="verify-delete-secondary-error-${id}" style="margin-top: -16px; margin-bottom: 16px;"></div>
                                <div class="secondary-auth-modal-buttons">
                                    <button class="btn btn-secondary" onclick="closeSecondaryAuthModal('${id}')">å–æ¶ˆ</button>
                                    <button class="btn btn-primary" onclick="verifyAndDeletePassword('${id}')">ç¡®å®š</button>
                                </div>
                            </div>
                        `;
                        
                        // æ·»åŠ åˆ°æ–‡æ¡£
                        document.body.appendChild(modal);
                    } else {
                        // æœªå¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯ï¼Œç›´æ¥åˆ é™¤
                        await window.passwordManager.deletePassword(id);
                        loadPasswords();
                        message.success('å¯†ç å·²åˆ é™¤');
                    }
                } catch (error) {
                    console.error('åˆ é™¤å¯†ç å¤±è´¥:', error);
                    message.error('åˆ é™¤å¯†ç å¤±è´¥');
                }
            }
        };
        
        // éªŒè¯å¹¶åˆ é™¤å¯†ç 
        window.verifyAndDeletePassword = async (id) => {
            const passwordInput = document.getElementById(`verify-delete-secondary-password-${id}`);
            const errorEl = document.getElementById(`verify-delete-secondary-error-${id}`);
            const secondaryPassword = passwordInput.value;
            
            if (!secondaryPassword) {
                errorEl.textContent = 'è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç ';
                return;
            }
            
            try {
                // å…ˆéªŒè¯äºŒæ¬¡å®‰å…¨å¯†ç 
                const verifyResult = await window.passwordManager.verifySecondaryPassword({
                    id: id,
                    secondaryPassword: secondaryPassword
                });
                
                if (verifyResult.success) {
                    // éªŒè¯æˆåŠŸï¼Œæ‰§è¡Œåˆ é™¤æ“ä½œ
                    await window.passwordManager.deletePassword(id);
                    
                    // å…³é—­å¼¹çª—
                    closeSecondaryAuthModal(id);
                    
                    // æ›´æ–°å¯†ç åˆ—è¡¨
                    loadPasswords();
                    message.success('å¯†ç å·²åˆ é™¤');
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    errorEl.textContent = 'äºŒæ¬¡å®‰å…¨éªŒè¯å¯†ç è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°å°è¯•';
                }
            } catch (error) {
                console.error('åˆ é™¤å¯†ç å¤±è´¥:', error);
                errorEl.textContent = 'åˆ é™¤å¯†ç å¤±è´¥ï¼Œè¯·é‡è¯•';
            }
        };

        // äºŒæ¬¡å®‰å…¨éªŒè¯å¼€å…³çš„æ˜¾ç¤º/éšè—é€»è¾‘
        const enableSecondaryAuthCheckbox = document.getElementById('enableSecondaryAuth');
        const secondaryPasswordGroup = document.getElementById('secondaryPasswordGroup');
        
        if (enableSecondaryAuthCheckbox && secondaryPasswordGroup) {
            enableSecondaryAuthCheckbox.addEventListener('change', () => {
                secondaryPasswordGroup.style.display = enableSecondaryAuthCheckbox.checked ? 'block' : 'none';
            });
        }

        // ä¿å­˜æ–°å¯†ç 
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(form);
            const enableSecondaryAuth = formData.get('enableSecondaryAuth') === 'on';
            const secondaryPassword = formData.get('secondaryPassword');
            
            // éªŒè¯äºŒæ¬¡å®‰å…¨å¯†ç 
            if (enableSecondaryAuth && !secondaryPassword) {
                message.error('è¯·è®¾ç½®äºŒæ¬¡å®‰å…¨å¯†ç ');
                return;
            }
            
            const passwordData = {
                service: formData.get('service'),
                username: formData.get('username'),
                password: formData.get('password'),
                enableSecondaryAuth: enableSecondaryAuth,
                secondaryPassword: secondaryPassword
            };

            await window.passwordManager.savePassword(passwordData);
            form.reset();
            
            // é‡ç½®äºŒæ¬¡å®‰å…¨éªŒè¯å¼€å…³çŠ¶æ€
            if (enableSecondaryAuthCheckbox) {
                enableSecondaryAuthCheckbox.checked = false;
            }
            if (secondaryPasswordGroup) {
                secondaryPasswordGroup.style.display = 'none';
            }
            
            // Element Plus é£æ ¼ä¿å­˜æˆåŠŸæç¤º
            message.success('å¯†ç å·²æˆåŠŸä¿å­˜ï¼');
            
            // è‡ªåŠ¨åˆ‡æ¢åˆ°å·²ä¿å­˜å¯†ç ç•Œé¢
            await showSavedPasswordsScreen();
        });

        // äºŒæ¬¡å®‰å…¨éªŒè¯å¼¹çª—
        function showSecondaryAuthModal(passwordId, password, callback) {
            // åˆ›å»ºå¼¹çª—å…ƒç´ 
            const modal = document.createElement('div');
            modal.className = 'secondary-auth-modal';
            modal.innerHTML = `
                <div class="secondary-auth-modal-content">
                    <h3>äºŒæ¬¡å®‰å…¨éªŒè¯</h3>
                    <div class="form-group">
                        <label for="secondary-auth-password-${passwordId}">è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç </label>
                        <input type="password" id="secondary-auth-password-${passwordId}" placeholder="è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç " required>
                    </div>
                    <div class="error-message" id="secondary-auth-error-${passwordId}" style="margin-top: -16px; margin-bottom: 16px;"></div>
                    <div class="secondary-auth-modal-buttons">
                        <button class="btn btn-secondary" onclick="closeSecondaryAuthModal('${passwordId}')">å–æ¶ˆ</button>
                        <button class="btn btn-primary" onclick="verifySecondaryPassword('${passwordId}', '${password}', ${callback ? 'true' : 'false'})">ç¡®å®š</button>
                    </div>
                </div>
            `;
            
            // æ·»åŠ åˆ°æ–‡æ¡£
            document.body.appendChild(modal);
            
            // ä¿å­˜å›è°ƒå‡½æ•°
            modal.callback = callback;
        }
        
        // å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯å¼¹çª—
        window.closeSecondaryAuthModal = (passwordId) => {
            const modal = document.querySelector('.secondary-auth-modal');
            if (modal) {
                document.body.removeChild(modal);
            }
        };
        
        // éªŒè¯äºŒæ¬¡å®‰å…¨å¯†ç 
        window.verifySecondaryPassword = async (passwordId, password, hasCallback) => {
            const passwordInput = document.getElementById(`secondary-auth-password-${passwordId}`);
            const errorEl = document.getElementById(`secondary-auth-error-${passwordId}`);
            const secondaryPassword = passwordInput.value;
            
            if (!secondaryPassword) {
                errorEl.textContent = 'è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç ';
                return;
            }
            
            try {
                const result = await window.passwordManager.verifySecondaryPassword({
                    id: passwordId,
                    secondaryPassword: secondaryPassword
                });
                
                if (result.success) {
                    // éªŒè¯æˆåŠŸï¼Œå…³é—­å¼¹çª—
                    closeSecondaryAuthModal(passwordId);
                    
                    // è°ƒç”¨å›è°ƒå‡½æ•°æ˜¾ç¤ºå¯†ç 
                    if (hasCallback) {
                        // ç›´æ¥æ˜¾ç¤ºå¯†ç 
                        const passwordTextEl = document.getElementById(`password-text-${passwordId}`);
                        const toggleBtnEl = passwordTextEl.nextElementSibling;
                        
                        passwordTextEl.textContent = password;
                        passwordTextEl.classList.add('visible');
                        toggleBtnEl.classList.add('visible');
                        toggleBtnEl.setAttribute('aria-pressed', 'true');
                        toggleBtnEl.querySelector('.btn-icon').textContent = 'ğŸ™ˆ';
                        toggleBtnEl.setAttribute('aria-label', 'éšè—å¯†ç ');
                        
                        // æ·»åŠ è‡ªåŠ¨éšè—æœºåˆ¶ï¼ˆ5ç§’åè‡ªåŠ¨éšè—ï¼‰
                        setTimeout(() => {
                            if (passwordTextEl.classList.contains('visible')) {
                                passwordTextEl.textContent = '*'.repeat(password.length);
                                passwordTextEl.classList.remove('visible');
                                toggleBtnEl.classList.remove('visible');
                                toggleBtnEl.setAttribute('aria-pressed', 'false');
                                toggleBtnEl.querySelector('.btn-icon').textContent = 'ğŸ‘ï¸';
                                toggleBtnEl.setAttribute('aria-label', 'æ˜¾ç¤ºå¯†ç ');
                            }
                        }, 5000);
                    }
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    errorEl.textContent = result.message;
                }
            } catch (error) {
                console.error('éªŒè¯äºŒæ¬¡å®‰å…¨å¯†ç å¤±è´¥:', error);
                errorEl.textContent = 'éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•';
            }
        };
        
        // å¯†ç å¯è§æ€§åˆ‡æ¢åŠŸèƒ½
        window.togglePasswordVisibility = (id, password, hasSecondaryAuth) => {
            const passwordTextEl = document.getElementById(`password-text-${id}`);
            const toggleBtnEl = passwordTextEl.nextElementSibling;
            const isVisible = passwordTextEl.classList.contains('visible');
            
            if (isVisible) {
                // åˆ‡æ¢ä¸ºéšè—çŠ¶æ€
                passwordTextEl.textContent = '*'.repeat(password.length);
                passwordTextEl.classList.remove('visible');
                toggleBtnEl.classList.remove('visible');
                toggleBtnEl.setAttribute('aria-pressed', 'false');
                toggleBtnEl.querySelector('.btn-icon').textContent = 'ğŸ‘ï¸';
                toggleBtnEl.setAttribute('aria-label', 'æ˜¾ç¤ºå¯†ç ');
            } else {
                // æ£€æŸ¥æ˜¯å¦éœ€è¦äºŒæ¬¡å®‰å…¨éªŒè¯
                if (hasSecondaryAuth) {
                    // æ˜¾ç¤ºäºŒæ¬¡å®‰å…¨éªŒè¯å¼¹çª—
                    showSecondaryAuthModal(id, password, true);
                } else {
                    // ç›´æ¥åˆ‡æ¢ä¸ºå¯è§çŠ¶æ€
                    passwordTextEl.textContent = password;
                    passwordTextEl.classList.add('visible');
                    toggleBtnEl.classList.add('visible');
                    toggleBtnEl.setAttribute('aria-pressed', 'true');
                    toggleBtnEl.querySelector('.btn-icon').textContent = 'ğŸ™ˆ';
                    toggleBtnEl.setAttribute('aria-label', 'éšè—å¯†ç ');
                    
                    // æ·»åŠ è‡ªåŠ¨éšè—æœºåˆ¶ï¼ˆ5ç§’åè‡ªåŠ¨éšè—ï¼‰
                    setTimeout(() => {
                        if (passwordTextEl.classList.contains('visible')) {
                            passwordTextEl.textContent = '*'.repeat(password.length);
                            passwordTextEl.classList.remove('visible');
                            toggleBtnEl.classList.remove('visible');
                            toggleBtnEl.setAttribute('aria-pressed', 'false');
                            toggleBtnEl.querySelector('.btn-icon').textContent = 'ğŸ‘ï¸';
                            toggleBtnEl.setAttribute('aria-label', 'æ˜¾ç¤ºå¯†ç ');
                        }
                    }, 5000);
                }
            }
        };
        
        // å¼€å¯/å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯
        window.toggleSecondaryAuth = (id, currentStatus) => {
            if (currentStatus) {
                // å·²å¼€å¯ï¼Œå…³é—­äºŒæ¬¡éªŒè¯
                disableSecondaryAuth(id);
            } else {
                // æœªå¼€å¯ï¼Œå¼€å¯äºŒæ¬¡éªŒè¯
                enableSecondaryAuth(id);
            }
        };
        
        // å¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯
        function enableSecondaryAuth(id) {
            // åˆ›å»ºè®¾ç½®äºŒæ¬¡å®‰å…¨å¯†ç çš„å¼¹çª—
            const modal = document.createElement('div');
            modal.className = 'secondary-auth-modal';
            modal.innerHTML = `
                <div class="secondary-auth-modal-content">
                    <h3>å¼€å¯äºŒæ¬¡å®‰å…¨éªŒè¯</h3>
                    <div class="form-group">
                        <label for="set-secondary-password-${id}">è®¾ç½®äºŒæ¬¡å®‰å…¨å¯†ç </label>
                        <input type="password" id="set-secondary-password-${id}" placeholder="è®¾ç½®äºŒæ¬¡å®‰å…¨å¯†ç " required>
                    </div>
                    <div class="form-group">
                        <label for="confirm-secondary-password-${id}">ç¡®è®¤äºŒæ¬¡å®‰å…¨å¯†ç </label>
                        <input type="password" id="confirm-secondary-password-${id}" placeholder="ç¡®è®¤äºŒæ¬¡å®‰å…¨å¯†ç " required>
                    </div>
                    <div class="error-message" id="set-secondary-auth-error-${id}" style="margin-top: -16px; margin-bottom: 16px;"></div>
                    <div class="secondary-auth-modal-buttons">
                        <button class="btn btn-secondary" onclick="closeSecondaryAuthModal('${id}')">å–æ¶ˆ</button>
                        <button class="btn btn-primary" onclick="saveSecondaryAuthSettings('${id}', true)">ç¡®å®š</button>
                    </div>
                </div>
            `;
            
            // æ·»åŠ åˆ°æ–‡æ¡£
            document.body.appendChild(modal);
        }
        
        // å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯
        function disableSecondaryAuth(id) {
            // æ˜¾ç¤ºç¡®è®¤å¼¹çª—
            if (window.confirm('ç¡®å®šè¦å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯å—ï¼Ÿ')) {
                // æ˜¾ç¤ºäºŒæ¬¡å®‰å…¨å¯†ç éªŒè¯å¼¹çª—
                const modal = document.createElement('div');
                modal.className = 'secondary-auth-modal';
                modal.innerHTML = `
                    <div class="secondary-auth-modal-content">
                        <h3>å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯</h3>
                        <div class="form-group">
                            <label for="verify-disable-secondary-password-${id}">è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç è¿›è¡ŒéªŒè¯</label>
                            <input type="password" id="verify-disable-secondary-password-${id}" placeholder="è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç " required>
                        </div>
                        <div class="error-message" id="verify-disable-secondary-error-${id}" style="margin-top: -16px; margin-bottom: 16px;"></div>
                        <div class="secondary-auth-modal-buttons">
                            <button class="btn btn-secondary" onclick="closeSecondaryAuthModal('${id}')">å–æ¶ˆ</button>
                            <button class="btn btn-primary" onclick="verifyAndDisableSecondaryAuth('${id}')">ç¡®å®š</button>
                        </div>
                    </div>
                `;
                
                // æ·»åŠ åˆ°æ–‡æ¡£
                document.body.appendChild(modal);
            }
        }
        
        // éªŒè¯å¹¶å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯
        window.verifyAndDisableSecondaryAuth = async (id) => {
            const passwordInput = document.getElementById(`verify-disable-secondary-password-${id}`);
            const errorEl = document.getElementById(`verify-disable-secondary-error-${id}`);
            const secondaryPassword = passwordInput.value;
            
            if (!secondaryPassword) {
                errorEl.textContent = 'è¯·è¾“å…¥äºŒæ¬¡å®‰å…¨å¯†ç ';
                return;
            }
            
            try {
                // å…ˆéªŒè¯äºŒæ¬¡å®‰å…¨å¯†ç 
                const verifyResult = await window.passwordManager.verifySecondaryPassword({
                    id: id,
                    secondaryPassword: secondaryPassword
                });
                
                if (verifyResult.success) {
                    // éªŒè¯æˆåŠŸï¼Œå…³é—­äºŒæ¬¡éªŒè¯
                    await window.passwordManager.updateSecondaryAuth({
                        id: id,
                        enableSecondaryAuth: false,
                        secondaryPassword: ''
                    });
                    
                    // å…³é—­å¼¹çª—
                    closeSecondaryAuthModal(id);
                    
                    // æ›´æ–°å¯†ç åˆ—è¡¨
                    showSavedPasswordsScreen();
                    message.success('äºŒæ¬¡å®‰å…¨éªŒè¯å·²å…³é—­');
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    errorEl.textContent = 'äºŒæ¬¡å®‰å…¨å¯†ç ä¸æ­£ç¡®';
                }
            } catch (error) {
                console.error('å…³é—­äºŒæ¬¡å®‰å…¨éªŒè¯å¤±è´¥:', error);
                errorEl.textContent = 'éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•';
            }
        };
        
        // ä¿å­˜äºŒæ¬¡å®‰å…¨éªŒè¯è®¾ç½®
        window.saveSecondaryAuthSettings = async (id, enable) => {
            const passwordInput = document.getElementById(`set-secondary-password-${id}`);
            const confirmInput = document.getElementById(`confirm-secondary-password-${id}`);
            const errorEl = document.getElementById(`set-secondary-auth-error-${id}`);
            
            const password = passwordInput.value;
            const confirmPassword = confirmInput.value;
            
            if (!password) {
                errorEl.textContent = 'è¯·è®¾ç½®äºŒæ¬¡å®‰å…¨å¯†ç ';
                return;
            }
            
            if (password !== confirmPassword) {
                errorEl.textContent = 'ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´';
                return;
            }
            
            try {
                await window.passwordManager.updateSecondaryAuth({
                    id: id,
                    enableSecondaryAuth: enable,
                    secondaryPassword: password
                });
                
                // å…³é—­å¼¹çª—
                closeSecondaryAuthModal(id);
                
                // æ›´æ–°å¯†ç åˆ—è¡¨
                showSavedPasswordsScreen();
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                message.success('äºŒæ¬¡å®‰å…¨éªŒè¯å·²' + (enable ? 'å¼€å¯' : 'å…³é—­'));
            } catch (error) {
                console.error('æ›´æ–°äºŒæ¬¡å®‰å…¨éªŒè¯è®¾ç½®å¤±è´¥:', error);
                errorEl.textContent = 'æ›´æ–°å¤±è´¥ï¼Œè¯·é‡è¯•';
            }
        };
    </script>
    
    <!-- Element Plus é£æ ¼é€šçŸ¥ç»„ä»¶ JavaScript -->
    <script>
        // Element Plus é£æ ¼é€šçŸ¥ç»„ä»¶ JavaScript
        class Message {
            constructor() {
                this.instances = [];
                this.verticalOffset = 20;
                this.zIndex = 999999;
            }

            // åˆ›å»ºé€šçŸ¥å…ƒç´ 
            createInstance(options) {
                const defaultOptions = {
                    type: 'info',
                    message: '',
                    duration: 3000,
                    showClose: true,
                    onClose: null
                };

                const finalOptions = { ...defaultOptions, ...options };
                const instance = document.createElement('div');
                instance.className = `el-message el-message--${finalOptions.type} el-message-fade-enter`;
                instance.style.zIndex = this.zIndex++;
                instance.style.top = `${this.verticalOffset}px`;

                // æ›´æ–°å‚ç›´åç§»é‡
                this.verticalOffset += 60;

                // åˆ›å»ºå†…å®¹
                let icon = '';
                switch (finalOptions.type) {
                    case 'success':
                        icon = 'âœ…';
                        break;
                    case 'warning':
                        icon = 'âš ï¸';
                        break;
                    case 'error':
                        icon = 'âŒ';
                        break;
                    case 'info':
                        icon = 'â„¹ï¸';
                        break;
                }

                let closeBtn = '';
                if (finalOptions.showClose) {
                    closeBtn = '<i class="el-message__closeBtn">Ã—</i>';
                }

                instance.innerHTML = `
                    <div class="el-message__icon">${icon}</div>
                    <div class="el-message__content">${finalOptions.message}</div>
                    ${closeBtn}
                `;

                // æ·»åŠ åˆ°DOM
                document.body.appendChild(instance);

                // è‡ªåŠ¨å…³é—­
                let timer = null;
                if (finalOptions.duration > 0) {
                    timer = setTimeout(() => {
                        this.close(instance, finalOptions.onClose);
                    }, finalOptions.duration);
                }

                // æ‰‹åŠ¨å…³é—­
                const closeBtnEl = instance.querySelector('.el-message__closeBtn');
                if (closeBtnEl) {
                    closeBtnEl.addEventListener('click', () => {
                        this.close(instance, finalOptions.onClose);
                    });
                }

                // å­˜å‚¨å®ä¾‹
                const instanceObj = {
                    el: instance,
                    timer
                };
                this.instances.push(instanceObj);

                return instanceObj;
            }

            // å…³é—­é€šçŸ¥
            close(instance, onClose) {
                // æŸ¥æ‰¾å®ä¾‹ç´¢å¼•
                const index = this.instances.findIndex(item => item.el === instance);
                if (index === -1) return;

                // æ¸…é™¤å®šæ—¶å™¨
                clearTimeout(this.instances[index].timer);

                // ç§»é™¤å®ä¾‹
                this.instances.splice(index, 1);

                // æ›´æ–°åç»­é€šçŸ¥çš„ä½ç½®
                this.updateVerticalOffset();

                // æ·»åŠ ç¦»å¼€åŠ¨ç”»
                instance.classList.remove('el-message-fade-enter');
                instance.classList.add('el-message-fade-leave');

                // ç§»é™¤DOM
                setTimeout(() => {
                    if (instance.parentNode) {
                        instance.parentNode.removeChild(instance);
                    }
                    if (onClose) onClose();
                }, 300);
            }

            // æ›´æ–°å‚ç›´åç§»é‡
            updateVerticalOffset() {
                this.verticalOffset = 20;
                this.instances.forEach((instance, index) => {
                    instance.el.style.top = `${this.verticalOffset}px`;
                    this.verticalOffset += 60;
                });
            }

            // å„ç§ç±»å‹çš„é€šçŸ¥æ–¹æ³•
            success(message, options = {}) {
                return this.createInstance({ ...options, type: 'success', message });
            }

            warning(message, options = {}) {
                return this.createInstance({ ...options, type: 'warning', message });
            }

            error(message, options = {}) {
                return this.createInstance({ ...options, type: 'error', message });
            }

            info(message, options = {}) {
                return this.createInstance({ ...options, type: 'info', message });
            }
        }

        // åˆ›å»ºå…¨å±€å®ä¾‹
        const message = new Message();
        
        // æ›¿æ¢å…¨å±€alertå‡½æ•°
        const originalAlert = window.alert;
        window.alert = function(msg) {
            message.info(msg);
        };
        
        // æ›¿æ¢å…¨å±€confirmå‡½æ•°ï¼ˆç®€åŒ–ç‰ˆï¼Œä»…æ”¯æŒç¡®å®šæ“ä½œï¼‰
        const originalConfirm = window.confirm;
        window.confirm = function(msg) {
            // åˆ›å»ºä¸€ä¸ªPromiseæ¥æ¨¡æ‹Ÿconfirmçš„å¼‚æ­¥è¡Œä¸º
            return new Promise((resolve) => {
                // åˆ›å»ºä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†ï¼ˆç®€åŒ–ç‰ˆï¼Œç›´æ¥è°ƒç”¨æˆåŠŸå›è°ƒï¼‰
                // æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬æ— æ³•çœŸæ­£æ›¿æ¢confirmçš„é˜»å¡è¡Œä¸ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹è°ƒç”¨confirmçš„ä»£ç 
                // è¿™é‡Œåªæ˜¯ä¸€ä¸ªä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼Œåé¢ä¼šä¿®æ”¹æ‰€æœ‰çš„confirmè°ƒç”¨
                resolve(true);
            });
        };
        
        // èƒŒæ™¯è®¾ç½®æ¨¡æ€æ¡†æ§åˆ¶
        function showSettingsModal() {
            const modal = document.getElementById('settingsModal');
            modal.style.display = 'flex';
            // åŠ è½½å½“å‰èƒŒæ™¯è®¾ç½®
            loadCurrentBackgroundSettings();
        }
        
        function closeSettingsModal() {
            const modal = document.getElementById('settingsModal');
            modal.style.display = 'none';
            // é‡ç½®æ–‡ä»¶è¾“å…¥
            document.getElementById('backgroundFileInput').value = '';
        }
        
        // è¯»å–æ–‡ä»¶ä¸ºDataURL
        function readFileAsDataURL(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
        
        // å‹ç¼©å›¾ç‰‡
        function compressImage(imageUrl, maxWidth) {
            return new Promise((resolve) => {
                const img = new Image();
                img.onload = () => {
                    let width = img.width;
                    let height = img.height;
                    
                    if (width > maxWidth) {
                        height = Math.round((height * maxWidth) / width);
                        width = maxWidth;
                    }
                    
                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    resolve(canvas.toDataURL('image/jpeg', 0.9));
                };
                img.src = imageUrl;
            });
        }
        
        // å¤„ç†æ–‡ä»¶é€‰æ‹©
        async function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const validTypes = ['image/jpeg', 'image/png', 'image/webp'];
            if (!validTypes.includes(file.type)) {
                message.error('ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼Œè¯·é€‰æ‹©JPGã€PNGæˆ–WebPæ ¼å¼çš„å›¾ç‰‡');
                return;
            }
            
            const maxSize = 10 * 1024 * 1024;
            if (file.size > maxSize) {
                message.error('æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ï¼ˆæœ€å¤§10MBï¼‰');
                return;
            }
            
            try {
                const imageUrl = await readFileAsDataURL(file);
                const compressedUrl = await compressImage(imageUrl, 1920);
                
                const preview = document.getElementById('backgroundPreview');
                const backgroundSize = document.getElementById('backgroundSize').value;
                
                preview.style.backgroundImage = `url(${compressedUrl})`;
                preview.style.backgroundSize = backgroundSize;
                preview.style.backgroundPosition = 'center';
                preview.style.backgroundRepeat = 'no-repeat';
                preview.dataset.backgroundUrl = compressedUrl;
                
                message.success('å›¾ç‰‡å·²åŠ è½½');
            } catch (error) {
                console.error('å¤„ç†å›¾ç‰‡å¤±è´¥:', error);
                message.error('å›¾ç‰‡å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }
        
        // æ›´æ–°é¢„è§ˆå°ºå¯¸
        function updatePreviewSize() {
            const preview = document.getElementById('backgroundPreview');
            const backgroundSize = document.getElementById('backgroundSize').value;
            const backgroundUrl = preview.dataset.backgroundUrl;
            
            if (backgroundUrl) {
                preview.style.backgroundSize = backgroundSize;
            }
        }
        
        // åº”ç”¨èƒŒæ™¯
        function applyBackground() {
            const preview = document.getElementById('backgroundPreview');
            const backgroundUrl = preview.dataset.backgroundUrl;
            const backgroundSize = document.getElementById('backgroundSize').value;
            
            if (!backgroundUrl) {
                message.error('è¯·å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡');
                return;
            }
            
            document.body.style.backgroundImage = `url(${backgroundUrl})`;
            document.body.style.backgroundSize = backgroundSize;
            document.body.style.backgroundPosition = 'center';
            document.body.style.backgroundRepeat = 'no-repeat';
            document.body.style.backgroundAttachment = 'fixed';
            
            localStorage.setItem('customBackground', JSON.stringify({
                url: backgroundUrl,
                size: backgroundSize,
                applied: true
            }));
            
            message.success('èƒŒæ™¯å·²åº”ç”¨');
            closeSettingsModal();
        }
        
        // é‡ç½®ä¸ºé»˜è®¤èƒŒæ™¯
        function resetBackground() {
            document.body.style.backgroundImage = '';
            document.body.style.backgroundSize = '';
            document.body.style.backgroundPosition = '';
            document.body.style.backgroundRepeat = '';
            document.body.style.backgroundAttachment = '';
            
            localStorage.removeItem('customBackground');
            
            const preview = document.getElementById('backgroundPreview');
            preview.style.backgroundImage = '';
            preview.dataset.backgroundUrl = '';
            
            message.success('å·²æ¢å¤é»˜è®¤èƒŒæ™¯');
        }
        
        // åŠ è½½å½“å‰èƒŒæ™¯è®¾ç½®
        function loadCurrentBackgroundSettings() {
            const settings = JSON.parse(localStorage.getItem('customBackground'));
            if (settings && settings.applied) {
                const preview = document.getElementById('backgroundPreview');
                const backgroundSizeSelect = document.getElementById('backgroundSize');
                
                preview.style.backgroundImage = `url(${settings.url})`;
                preview.style.backgroundSize = settings.size;
                preview.dataset.backgroundUrl = settings.url;
                backgroundSizeSelect.value = settings.size;
            }
        }
        
        // åˆå§‹åŒ–èƒŒæ™¯
        function initBackground() {
            const settings = JSON.parse(localStorage.getItem('customBackground'));
            if (settings && settings.applied) {
                document.body.style.backgroundImage = `url(${settings.url})`;
                document.body.style.backgroundSize = settings.size;
                document.body.style.backgroundPosition = 'center';
                document.body.style.backgroundRepeat = 'no-repeat';
                document.body.style.backgroundAttachment = 'fixed';
            }
        }
        
        // åˆå§‹åŒ–èƒŒæ™¯
        initBackground();
    </script>
    
    <!-- è®¾ç½®ç•Œé¢ -->
    <div id="settingsScreen" class="container" style="display: none;">
        <header>
            <button class="btn btn-small" onclick="showPasswordManagerScreen()" style="position: absolute; left: 20px; top: 16px;">
                <span class="btn-icon">â†</span> è¿”å›
            </button>
            <h1>è®¾ç½®</h1>
        </header>
        <div class="settings-layout">
            <!-- å·¦ä¾§è®¾ç½®é¡¹å¯¼èˆª -->
            <div class="settings-sidebar">
                <button class="settings-item active" onclick="showSetting('background')">èƒŒæ™¯è®¾ç½®</button>
                <!-- åç»­å¯æ·»åŠ å…¶ä»–è®¾ç½®é¡¹ -->
                <!-- <button class="settings-item" onclick="showSetting('security')">å®‰å…¨è®¾ç½®</button> -->
                <!-- <button class="settings-item" onclick="showSetting('appearance')">å¤–è§‚è®¾ç½®</button> -->
                <!-- <button class="settings-item" onclick="showSetting('about')">å…³äº</button> -->
            </div>
            <!-- å³ä¾§è®¾ç½®å†…å®¹åŒº -->
            <div class="settings-content">
                <!-- èƒŒæ™¯è®¾ç½®å†…å®¹ -->
                <div id="background-settings" class="settings-section">
                    <h3>è‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡</h3>
                    <!-- èƒŒæ™¯é¢„è§ˆåŒºåŸŸ -->
                    <div id="backgroundPreview" style="
                        width: 100%; 
                        height: 200px; 
                        border: 1px solid var(--ios-gray-light); 
                        border-radius: var(--ios-corner-large); 
                        margin: 20px 0; 
                        overflow: hidden; 
                        background-size: cover; 
                        background-position: center; 
                        background-repeat: no-repeat;
                        box-shadow: var(--ios-shadow-sm);
                    "></div>
                    <!-- èƒŒæ™¯å°ºå¯¸è°ƒæ•´é€‰é¡¹ -->
                    <div class="form-group">
                        <label for="backgroundSize">èƒŒæ™¯å°ºå¯¸</label>
                        <select id="backgroundSize" style="
                            width: 100%; 
                            padding: 12px; 
                            border: 1px solid var(--ios-gray-light); 
                            border-radius: var(--ios-corner-large); 
                            font-size: 14px; 
                            background-color: var(--ios-card);
                        " onchange="updatePreviewSize()">
                            <option value="cover" selected>è¦†ç›–ï¼ˆé“ºæ»¡å±å¹•ï¼Œä¿æŒæ¯”ä¾‹ï¼‰</option>
                            <option value="contain">åŒ…å«ï¼ˆå®Œæ•´æ˜¾ç¤ºï¼Œä¿æŒæ¯”ä¾‹ï¼‰</option>
                            <option value="stretch">æ‹‰ä¼¸ï¼ˆé“ºæ»¡å±å¹•ï¼Œä¸ä¿æŒæ¯”ä¾‹ï¼‰</option>
                            <option value="center">å±…ä¸­ï¼ˆå±…ä¸­æ˜¾ç¤ºï¼ŒåŸå§‹å°ºå¯¸ï¼‰</option>
                        </select>
                    </div>
                    <!-- éšè—çš„æ–‡ä»¶é€‰æ‹©å™¨ -->
                    <input type="file" id="backgroundFileInput" accept="image/jpeg, image/png, image/webp" style="display: none;" onchange="handleFileSelect(event)">
                    <!-- æ“ä½œæŒ‰é’® -->
                    <div class="settings-buttons" style="display: flex; flex-direction: column; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-primary" onclick="document.getElementById('backgroundFileInput').click()">é€‰æ‹©èƒŒæ™¯å›¾ç‰‡</button>
                        <button class="btn btn-success" onclick="applyBackground()">åº”ç”¨ä¸ºèƒŒæ™¯</button>
                        <button class="btn btn-secondary" onclick="resetBackground()">é‡ç½®ä¸ºé»˜è®¤</button>
                    </div>
                </div>
                <!-- åç»­å¯æ·»åŠ å…¶ä»–è®¾ç½®å†…å®¹ -->
            </div>
        </div>
    </div>
</body>
</html>